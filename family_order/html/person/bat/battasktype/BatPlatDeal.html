<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--$Id: PlatOrder.html,v 1.3 2014/03/18 13:53:09 xiekl Exp $-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head jwcid="@Head">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>批量平台业务受理</title>
</head>
<body jwcid="@Body"><div class="m_wrapper"><div class="m_wrapper2">

<!-- 区域 开始 -->
<div class="c_box">
	<!-- 标题 开始 -->
	<div class="c_title">
		<div class="text">批量任务基本信息</div>
	</div>
	<!-- 标题 结束 -->
	<!-- 表单 开始 -->
	<div class="c_form c_form-label-10 c_form-col-2" jwcid="BatBaseInfoPart@Part">
		<ul class="ul">
			<li class="li">
				  <span class="label"><span class="e_required">批量任务名称：</span></span>
					<span class="e_input"><span>
					<input jwcid="@TextField" name="BATCH_TASK_NAME" value="ognl:info.BATCH_TASK_NAME" nullable="no" maxsize="50" desc="批量任务名称" />
					</span></span>
			</li>
			<li class="li">
				  <span class="label"><span class="e_required">核批文号：</span></span>
					<span class="e_input"><span>
						<input jwcid="@TextField" name="AUDIT_NO" value="ognl:info.AUDIT_NO" nullable="no" rows="1" maxsize="50" desc="核批文号"  />
			</span></span>
			</li>
		    <li class="li">
		    <span class="label"><span class="e_required">任务起始时间：</span></span>
					<span class="e_input"><span> 
					<input jwcid="@DateField"
								name="START_DATE"
								format="yyyy-MM-dd"
								readonly="true"
								desc="任务起始时间："
								maxName="END_DATE"
								min="ognl:pageutil.getSysDate()"
								value="ognl:info.START_DATE"
							/>
			      </span></span>
		    </li>
		     <li class="li">
		    <span class="label"><span class="e_required">任务终止时间：</span></span>
					<span class="e_input"><span> 
						<input jwcid="@DateField"
								name="END_DATE"
								format="yyyy-MM-dd"
								readonly="true"
								desc="任务终止时间"
								minName="START_DATE"
								min="ognl:pageutil.getSysDate()"
								value="ognl:info.END_DATE"
							/>	
						</span></span>
		    </li>
		     <li class="li">
		    <span class="label"><span>备注：</span></span>
		    <span class="e_textarea">
						<span class="e_textareaTop"><span></span></span>
						<span class="e_textareaContent">
							<textarea jwcid="@TextArea" name="REMARK" 
							value="ognl:info.REMARK" nullable="yes" 
						     desc="备注" 
							  />
						</span>
						<span class="e_textareaBottom"><span></span></span>
		    </span>
		    </li> 
		  
		</ul>
		<input jwcid="@Hidden" name="BATCH_OPER_TYPE" type="text" value="BATPLATFORM"   desc="平台类型编码" />
		<input jwcid="@Hidden" name="BATCH_OPER_NAME" type="text" value="批量业务平台业务_多笔"    desc="平台类型名称" />								
	</div>
	<!-- 表单 结束 -->
	 
  <!-- 区域开始 -->
	<div class="c_title c_title-2">
		 <div class="text">请选择批量条件</div>
  	</div>
	<!-- 表格 开始 -->
	<div jwcid="BatConditionPart@Part"  class="c_form c_form-label-6 c_form-col-2" element="div">
	<ul class="ul">
				<li class="li">
					  <span class="label"><span class="e_required">批量条件1：</span></span>
						<span class="e_elements">
						<button type="button" class="e_button-right" id="btBatchCond1" onclick="javascript:popupPage('bat.battasktype.PlatTask','initBatPopuPages','&COMP_ID=CODING1&DATA='+encodeURIComponent($('#CODING1').val()),'批量平台业务',1000,600,'CODING1')">
						<i class="e_ico-check"></i><span></span></button>
						<span class="e_input e_input-left"><span>
						<input type="text" jwcid="@Popup" readOnly="true" 
						value="ognl:info.CODING1" 
						text="ognl:info.CODING1" 
						name="CODING1" id="CODING1" 
						afterAction=""
						nullable = "no"
						desc="批量条件1"/>
						</span></span>
					</span>	
				</li>
				<li class="li">
					  <span class="label"><span class="e_required">批量条件2：</span></span>
						<span class="e_elements">
						<button type="button" class="e_button-right" id="btBatchCond2" onclick="javascript:popupPage('bat.battasktype.PlatTask','initBatPopuPages','&COMP_ID=CODING2&DATA='+encodeURIComponent($('#CODING2').val()),'批量平台业务',1000,600,'CODING2')">
						<i class="e_ico-check"></i><span></span></button>
						<span class="e_input e_input-left"><span>
						<input type="text" jwcid="@Popup" readOnly="true" 
						value="ognl:info.CODING2" 
						text="ognl:info.CODING2" 
						name="CODING2" id="CODING2" 
						afterAction=""
						nullable="no"
						desc="批量条件2"/>
						</span></span>
				</span>
				</li>
			    <li class="li">
			    <span class="label">批量条件3：</span>
					<span class="e_elements">
						<button type="button" class="e_button-right" id="btBatchCond3" onclick="javascript:popupPage('bat.battasktype.PlatTask','initBatPopuPages','&COMP_ID=CODING3&DATA='+encodeURIComponent($('#CODING3').val()),'批量平台业务',1000,600,'CODING3')">
						<i class="e_ico-check"></i><span></span></button>
						<span class="e_input e_input-left"><span>
						<input type="text" jwcid="@Popup" readOnly="true" 
						value="ognl:info.CODING3" 
						text="ognl:info.CODING3" 
						name="CODING3" id="CODING3" 
						afterAction=""
						desc="批量条件3"/>
						</span></span>
				</span>
			    </li>
			     <li class="li">
			    <span class="label">批量条件4：</span>
							<span class="e_elements">
						<button type="button" class="e_button-right" id="btBatchCond4" onclick="javascript:popupPage('bat.battasktype.PlatTask','initBatPopuPages','&COMP_ID=CODING4&DATA='+encodeURIComponent($('#CODING4').val()),'批量平台业务',1000,600,'CODING4')">
						<i class="e_ico-check"></i><span></span></button>
						<span class="e_input e_input-left"><span>
						<input type="text" jwcid="@Popup" readOnly="true" 
						value="ognl:info.CODING4" 
						text="ognl:info.CODING4" 
						name="CODING4" id="CODING4" 
						afterAction=""
						desc="批量条件4"/>
						</span></span>
				</span>
			    </li>
			  
			</ul>
	<!-- 表格 结束 -->
 	</div>
	
	<!-- 区域开始 -->
	<div class="c_title">
			<div class="text">批量数据</div>
		</div>
		<div class="c_form c_form-col-1 c_form-label-11" jwcid="DataImportPart@Part">
			<ul class="ul">
				<li class="li">
				<span class="label"><span class="e_required">上传前请查看模板格式：</span></span>
				<span class="text">
					<a jwcid="@Any" id="A_TEMPLATE_DATA_XLS" name="A_TEMPLATE_DATA_XLS" 
					href="ognl:encodeUrl('attach?action=downloadweb&realName=批量业务平台业务.xls&filePath=template/bat/BATPLATFORM.xls')">
						<span jwcid="@Insert" value="[点击下载]"></span>
					</a>
				</span>
				</li>
				<li class="li" >
					<span class="label"><span class="e_required">导入文件：</span></span>
					<span class="text">
					<input jwcid="@SimpleUpload" name="FILE_ID" ftpSite="personserv" filePath="" fileSize="20" fileTypes="*.xls;*.xlsx" 
					nullable="no" desc="导入文件"/>
					</span>
				</li>
			</ul>
		</div>
		
<!-- 区域 结束 -->

		
</div>
<div class="c_box">
		 <div jwcid="SubmitPart@csserv:CSSubmit" 
		        beforeAction="createPlatBatch()" 
		        params="" isReset="false" 
		        disabledBtn = "false"
		        listener="" 
		        refreshPart="" 
		        isDeafault ="true"
		        area="BatBaseInfoPart,BatConditionPart,DataImportPart" element="div"/>
</div>


</body>
<script language="javascript">
function createPlatBatch()
{
     	//查询条件校验
	if(!$.validate.confirmAll()) {
		return false;
	}
	
     var flag = false;
	 var codingStr1 = $("#CODING1").val();	
     var codingStr2 = $("#CODING2").val();	
     var codingStr3 = $("#CODING3").val();	
     var codingStr4 = $("#CODING4").val();	
     
     if(codingStr1 == codingStr2 )
     {
    	 flag = true;
     }
     
     if(codingStr3!='')
     {
    	 if(codingStr1 == codingStr3 ||  codingStr2 == codingStr3)
    	 {
    		 flag = true;
    	 }
     }
     
     if(codingStr4 != '')
     {
    	 if(codingStr1 == codingStr4 || codingStr2 == codingStr4 || codingStr3 == codingStr4)
    	 {
    		 flag = true;
    	 }
     }
     
     if(flag)
     {
    	 MessageBox.alert("提示","任意两个批量条件不能相同");
    	 return;
     }
     
     	
	
	$.beginPageLoading("正在提交数据...");
	
	ajaxSubmit('BatBaseInfoPart,BatConditionPart,DataImportPart', 'createPlatBatch', null, null, function(data){
    var batchTaskId = data.get("BATCH_TASK_IDS");
	var content = "批量平台业务受理,<br/> 点击[<a   href='javascript:$.closeMessage(this);$.cssubmit.resetTrade();'>返回</a>]返回本页面，";
	content += "点击[<a href='#nogo' onclick='javascript:openNav(\"批量任务启动\",\"bat.battaskstart.BatTaskStart&listener=queryBatTaskStart&FROM_PAGE=2&BATCH_ID="+batchTaskId+"\",\"\",\"\");'>批量任务启动</a>]到批量任务启动页面<br/>批量任务流水号(BATCH_ID)："+batchTaskId; 
	$.showSucMessage("批量平台业务受理结果!",content);
		
	$.endPageLoading();
	},
	function(error_code,error_info){
		$.endPageLoading();
		alert(error_info);
	}
	 );
}

</script>
</html>
 
 