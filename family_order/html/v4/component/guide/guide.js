!function(t){"undefined"==typeof t.guide&&(t.guide=function(i){return new t.guide.fn.construct(i)},t.guide.fn={construct:function(t){this.id=t,this.listId=t+"_anchors",this.initEvents()},get:function(t){return window["Guide_"+t]},getSteps:function(){for(var i=t("#"+this.listId).children(),e=new Array,n=0;n<i.length;n++)e[n]=this.getStepByIndex(n);return e},getActiveStep:function(){var i=null,e=t("#"+this.listId+" li[class *= active]");if(e&&1==e.length){var n=t(e.get(0)).find("a").text(),r=this.indexOf(n);i=this.getStepByIndex(parseInt(r))}return i},getStepByIndex:function(i){var e=null,n=t("#"+this.listId).children();if(i>=0&&i<n.length){var r=n.get(i),s=t(r).find("a"),a=s.attr("href"),d=s.text();e={anchor:a,text:d}}return e},initSteps:function(i){var e=this;return 0==t.isArray(i)?void alert("can not init steps for guide '"+this.id+"', steps must be array."):(e.cleanup(),void t.each(i,function(t,i){e.addStep(i.text,i.anchor)}))},cleanup:function(){t("#"+this.listId).html("")},addStep:function(i,e,n){if(0==t.isString(i)||""==t.trim(i))return void alert("can not add step to guide '"+this.id+"', text is required.");if(0==t.isString(e)||""==t.trim(e))return void alert("can not add step to guide '"+this.id+"', anchor is required.");var r=t("#"+this.listId),s=r.children().length;if(n=void 0==n?s:n,!(n<0||s>0&&n>s)){var a=t('<li class=""><a href="'+("#"==e.match("^#")?e:"#"+e)+'">'+i+"</a></li>"),d=this.indexOf(i);if(d>=0){var l=t(r.children().get(d));l.replaceWith(a)}else if(s==n)a.appendTo(r);else{var c=r.children().get(n);a.insertBefore(c)}$allItem=r.children();var f="first",o="last";$allItem.removeClass(f),$allItem.removeClass(o),t($allItem.first()).addClass(f),t($allItem.last()).addClass(o)}},activeStep:function(i){if(t.isString(i)){var e=this.indexOf(i);if(e>=0){var n=t("#"+this.listId).children(),r=t(n.get(e)),s=r.find("a")[0];if(document.all)s.click();else if(document.createEvent){var a=document.createEvent("MouseEvents");a.initEvent("click",!1,!0),s.dispatchEvent(a)}this.selectStep(i)}}},selectStep:function(i){if(t.isString(i)){var e=this.indexOf(i);if(e>=0){var n=t("#"+this.listId).children(),r=t(n.get(e)),s="active";t("#"+this.listId+" li[class *= active]").removeClass(s),r.addClass(s)}}},removeStep:function(i){var e=t("#"+this.listId).children(),n=t(e.get(this.indexOf(i)));if(n&&n.length>0){n.remove(),e=t("#"+this.listId).children();var r="first",s="last";e.removeClass(r),e.removeClass(s),t(e.first()).addClass(r),t(e.last()).addClass(s)}},indexOf:function(i){if(0==t.isString(i))return-1;var e=-1,n=t("#"+this.listId).children();return t.each(n,function(n,r){var s=t(r).find("a").text();if(t.trim(s)==t.trim(i))return void(e=n)}),e},initEvents:function(){var i=this;t("#"+i.listId).bind("click",function(e){var n=e.target;if("A"===n.tagName.toUpperCase()){var r=i.getActiveStep(),s=null==r?null:r.text,a=t(n).text();s!=a&&0!=i.onSwitchAction(s,a)&&i.selectStep(a)}})},onSwitchAction:function(i,e){var n=!0,r=t("#"+this.id).attr("switchAction");if(r){var s=r.indexOf("("),a=s>0?r.substring(0,s):r,d=t("#"+this.id)[0],l="return window."+a+"?"+a+".call(t, c, n):false;";n=new Function("t","c","n",l)(d,i,e)}return n}},t.guide.fn.construct.prototype=t.guide.fn,t.guide.get=t.guide.fn.get)}(Wade);