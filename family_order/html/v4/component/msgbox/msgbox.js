!function(t){"undefined"==typeof t.msgbox&&(t.msgbox=function(i,s){return new t.msgbox.fn.construct(i,s)},t.msgbox.fn={construct:function(i,s){if(this.id=i?i:"wade_msgbox_simple",t("#"+i).length<=0){var n='<div class="c_msgBox" id="'+this.id+'" name="'+this.id+'" isComponent="false" style="display:none;"><div class="c_msgBoxContent"><div class="c_msgBoxTitle"><div id="'+this.id+'_title" class="text"></div><div class="fn"><a id="'+this.id+'_close" href="#nogo" class="close"></a></div></div><div class="c_msgBoxWrapper"><iframe src="" page="" subsys="" listenerName="" params="" style="width:100%; height:100%; display:none;"></iframe><div id="'+this.id+'_article" class="c_article" style="display:none;"></div><div id="'+this.id+'_submit" class="c_submit" style="display:none;"></div><input id="'+this.id+'_customData" type="hidden" value="" /></div></div><div class="c_msgBoxShadow"></div></div>';t(document.body).append(n),window["MsgBox_"+this.id]=this}this.init(s)},get:function(t){return window["MsgBox_"+t]},setTitle:function(i){var s="";i&&t.isString(i)&&(s=i),t("#"+this.id+"_title").text(s)},hideDefaultButton:function(){this.defaultBtnShow&&1==this.isComponent&&(this.defaultBtns.css("display","none"),this.defaultBtnShow=!1,this.buttonCountChanged())},showDefaultButton:function(){0==this.defaultBtnShow&&1==this.isComponent&&(this.defaultBtns.css("display",""),this.defaultBtnShow=!0,this.buttonCountChanged())},removeCustomButtons:function(){for(var i=t("#"+this.id+"_submit button"),s=0;s<i.length;s++){var n=t(i[s]);"true"!=n.attr("default")&&n.remove()}this.buttonCountChanged()},addCustomButton:function(i){var s=t("#"+this.id+"_submit"),n=i.text;if(void 0==n)return void alert("Can not add button to MsgBox "+this.id+" , because text is undefined!");var e=void 0==i.onclick?"":i.onclick,o=void 0==i.className?"":i.className,a=t('<button onclick="'+e.replace(/\"/g,"'")+'" type="button"><i class="'+o+'"></i><span>'+n+"</span></button>");a.appendTo(s),this.buttonCountChanged()},setCustomButtons:function(i){if(!(t.isArray(i)||i instanceof t.DatasetList))return void alert("can not set custom buttons for MsgBox "+this.id+", buttons must be Array or DatasetList!");this.removeCustomButtons();for(var s=0;s<i.length;s++){var n=i instanceof t.DatasetList?i.get(s):i[s];this.addCustomButton(n)}},buttonCountChanged:function(){var i=t("#"+this.id+"_submit");0==this.defaultBtnShow&&this.defaultBtns.length==i.children().length?i.css("display","none"):i.css("display","")},open:function(i,s){if(!this.isOpen())if(t.isString(i)&&""!=t.trim(i)&&(this.identifier=i),void 0==s&&0==this.isComponent&&(s=!1),0==s)t("#"+this.id).css("display",""),t.msgbox.fn.events.onMsgBoxOpen(this);else if(1==s)t("#"+this.id).css("display","none");else{var n=this;this.doAjaxSubmit("actionType=hasShow",function(i){t.endPageLoading(),1!=i.get("result")&&(t("#"+n.id).css("display",""),t.msgbox.fn.events.onMsgBoxOpen(n))},function(i,s){t.showErrorMessage(s),t.endPageLoading()})}},close:function(){0!=this.isOpen()&&(t("#"+this.id).css("display","none"),t.msgbox.fn.events.onMsgBoxClose(this),this.empty(),this.layoutBoxes())},empty:function(){this.setTitle(null),this.setArticle(null),this.setUrl(null),this.removeCustomButtons(),1==this.isComponent&&this.showDefaultButton(),this.setCustomData(null)},layoutBoxes:function(){var i=window.g_opened_msgboxes;if(i&&i.length>0){var s=0;t("#"+i.get(i.length-1).id).css("bottom",0);for(var n=i.length-1;n>0;n--)s+=t("#"+i.get(n).id).height()+1,t("#"+i.get(n-1).id).css("bottom",s)}},isOpen:function(){return"none"!=t("#"+this.id).css("display")},setArticle:function(i){var s=t("#"+this.id+"_article");s.html("");var n="none";if(i&&t.isString(i)){var e=t("#"+i);if(e.length){var o=e.clone(!0);e.remove(),s.append(o),n=""}}s.css("display",n)},getArticle:function(){return t("#"+this.id+"_article").html()},setPage:function(i,s,n,e){if(s&&t.isString(s)&&""!=t.trim(s)){var o=t("#"+this.id+" iframe");i=i&&t.isString(i)?i:null,n=n&&t.isString(n)?n:null,e=e&&t.isString(e)?e:null,o.attr("src",t.redirect.buildUrl(i,s,n,e)),o.css("display","")}},setUrl:function(i){var s=t("#"+this.id+" iframe"),n="about:blank",e="none";i&&t.isString(i)&&""!=t.trim(i)&&(n=i,e=""),s.attr("src",n),s.css("display",e)},getUrl:function(){return t("#"+this.id+" iframe").attr("src")},setCustomData:function(i){var s="";i&&(s=i),t("#"+this.custDataId).val(s)},getCustomData:function(){return t("#"+this.custDataId).val()},getContentData:function(){var t="";if(void 0==this.identifier){var i=this.getUrl(),s=this.getArticle();i&&(t+=i),s&&(t+=s)}else t=this.identifier;return t},init:function(i){if(this.isComponent="true"==t("#"+this.id).attr("isComponent"),this.defaultBtns=t("#"+this.id+" button[default=true]"),this.defaultBtnShow=!0,this.custDataId=this.id+"_customData",i&&(this.afterAction=t.isFunction(i)?i:new Function("return "+i+";")),1==this.isComponent){var s=t("#"+this.id+" div[divid]");if(s.length){var n=s.attr("divid");this.setArticle(n)}"false"==t("#"+this.id).attr("showDefaultButton")&&this.hideDefaultButton()}var e=t("#"+this.id+"_close");if(e.unbind("click"),e.bind("click",t.msgbox.fn.events.onCloseClick),1==this.isComponent){var o=t("#"+this.id+"_ok");o.unbind("click"),o.bind("click",t.msgbox.fn.events.onOkClick);var a=t("#"+this.id+"_cancel");a.unbind("click"),a.bind("click",t.msgbox.fn.events.onCancelClick)}this.layoutBoxes()},doAjaxSubmit:function(i,s,n){var e=this,o="&content="+e.getContentData()+"&customData="+e.getCustomData()+"&wade_renderType=1";i&&t.isString(i)&&""!=t.trim(i)&&(o="&"==i.match("^&")?o+i:o+"&"+i),ajaxSubmit(null,null,o,e.id,s,n)},events:{onOkClick:function(i){var s=t(this).parents("div[class=c_msgBox]").attr("id"),n=t.msgbox.get(s);n.afterAction&&0==n.afterAction.call(this,i)||n.doAjaxSubmit("actionType=ok",function(i){t.endPageLoading(),n.close()},function(i,s){t.showErrorMessage(s),t.endPageLoading()})},onCancelClick:function(i){var s=t(this).parents("div[class=c_msgBox]").attr("id"),n=t.msgbox.get(s);n.afterAction&&0==n.afterAction.call(this,i)||n.doAjaxSubmit("actionType=noshow",function(i){t.endPageLoading(),n.close()},function(i,s){t.showErrorMessage(s),t.endPageLoading()})},onCloseClick:function(i){var s=t(this).parents("div[class=c_msgBox]").attr("id"),n=t.msgbox.get(s);if(!n.afterAction||0!=n.afterAction.call(this,i))return 0==n.isComponent?void n.close():void n.doAjaxSubmit("actionType=close",function(i){t.endPageLoading(),n.close()},function(i,s){t.showErrorMessage(s),t.endPageLoading()})},onMsgBoxOpen:function(i){void 0==window.g_opened_msgboxes&&(window.g_opened_msgboxes=new t.DatasetList),window.g_opened_msgboxes.add(i),i.layoutBoxes()},onMsgBoxClose:function(i){void 0==window.g_opened_msgboxes&&(window.g_opened_msgboxes=new t.DatasetList),window.g_opened_msgboxes.remove(i)}}},t.msgbox.fn.construct.prototype=t.msgbox.fn,t.msgbox.get=t.msgbox.fn.get)}(Wade);