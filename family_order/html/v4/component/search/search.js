!function(t){function i(i,e){if(!i)return-1;t.isString(i)?i=new Array(i):i.hasOwnProperty("items")&&(i=i.items);for(var a=0,n=i.length,s=0;s<n;s++){if(title=i[s].toUpperCase(),e.indexOf(" ")>0){for(var o=e.split(" "),r=0;r<o.length;r++)if(""!=o[r]){var h=title.indexOf(o[r]);if(h<0){a=-1;break}0==r&&(a=h)}}else a=title.indexOf(e);if(a>=0)break}return i=null,a}"undefined"==typeof t.Search&&(t.Search=function(i,e,a,n){var s=new t.Search.fn.constructor(i,e,a,n);return s},t.Search.fn={constructor:function(i,e,a,n){this.id=i,this.pageName=e,this.listenerName=a;var s=t("#"+this.id),o=s.attr("clickAction");o&&(this.clickAction=new Function("return "+o+";")());var r=s.attr("afterAction");r&&(this.afterAction=new Function("return "+r+";")());var h=s.attr("enterAction");h&&(this.enterAction=new Function("return "+h+";")());var c=s.attr("keyUpAction");c&&(this.keyUpAction=new Function("return "+c+";")());var l=s.attr("keyDownAction");l&&(this.keyDownAction=new Function("return "+l+";")());var d=s.attr("optionEnterAction");d&&(this.optionEnterAction=new Function("return "+d+";")());var u=s.attr("optionClickAction");u&&(this.optionClickAction=new Function("return "+u+";")()),t.extend(this,n)},get:function(t){return window["Search_"+t]},setSearchData:function(t){this.searchData=t},downLoadedStatusTrue:function(){if(0==this.dataLoaded&&(this.dataLoaded=!0,this.nextSearchValue&&""!=this.nextSearchValue)){var t=this.nextSearchValue;this.nextSearchValue="",this.beginSearch(t)}},beginSearch:function(i,e){if(this.searchPosition=parseInt(this.searchPosition,10),!(i.length<this.searchPosition)){if(!this.dataLoaded)return void(this.nextSearchValue=i);if(this.dataLoaded=!1,this.nextSearchValue="","visible"!=t("#Div_Search_"+this.id).css("visibility")){var a=t.initPosition(t("#"+this.id),this.width);!t("#Div_Search_"+this.id)||t("#Div_Search_"+this.id).length<1?this.createOptionHtml(a.topPx,a.leftPx,a.widthPx):this.updatePosition(a.topPx,a.leftPx,a.widthPx)}var n=this.id,s=t.Search.get(n);if(this.dynamic&&"false"!=this.dynamic)return void this.getAjaxData(i,function(){s.updateOptionHtml(s.searchData),t.updateTopPos(t("#"+n),"Div_Search_"+n),s.showSearch(),e&&t.isFunction(e)&&e.call(s,i)});if(!this.searchData)return void this.getAjaxData(i,function(){s.updateOptionHtml(s.readMemoryData(i)),t.updateTopPos(t("#"+n),"Div_Search_"+n),s.showSearch(),e&&t.isFunction(e)&&e.call(s,i)});this.dynamic&&"false"!=this.dynamic?this.updateOptionHtml(this.searchData):this.updateOptionHtml(this.readMemoryData(i)),this.downLoadedStatusTrue(),t.updateTopPos(t("#"+this.id),"Div_Search_"+this.id),this.showSearch()}},showSearch:function(){t("#Div_Search_"+this.id).css("visibility","visible")},hiddenSearch:function(){t("#Div_Search_"+this.id).css("visibility","hidden")},readMemoryData:function(e){if(!e||""==e)return this.searchData;var a=new t.DatasetList;if(this.searchData&&e){e=t.trim(e).toUpperCase();for(var n,s,o,r=[],h=0;h<this.searchData.length;h++){var c=-1,l=this.searchData.get(h);n=l.get(this.searchCode),s=l.get("Search_AllSpell"),o=l.get("Search_FirstSpell"),escape(e).indexOf("%u")<0&&(c=i(o,e),c<0&&(c=i(s,e))),c<0&&(c=i(n,e)),c>-1&&r.push([h,c])}r.sort(function(t,i){return t[1]-i[1]});for(var h=0;h<r.length;h++)a.add(this.searchData.get(r[h][0]));r=null}return a},getAjaxData:function(i,e){function a(a){var n=a.context;"0"!=n.x_resultcode?(s=new t.DatasetList(""),t.Search.get(o).ajaxCallback(i,s,e,!0,n.x_resultinfo)):(s=a.data,s=new t.DatasetList(s),t.Search.get(o).ajaxCallback(i,s,e,!1))}if(!(this.listenerName||this.componentId||this.clazz&&this.method))return void alert(t.lang["view.web.component.serach.nodatasrc"]);var n=this.params;n&&n instanceof t.DataMap&&n.length&&(n=n.map),t.isObject(n)&&(n=t.param(n)),i||(i="");var s="";n?n+="&"+this.searchCode+"="+encodeURIComponent(i):n=this.searchCode+"="+encodeURIComponent(i),this.dynamic&&"false"!=this.dynamic&&(n+="&pagin=nav",n+="&nav_count=1",n+="&nav_current=0",n+="&nav_pagesize="+this.maxOption,n+="&nav_needcount=true");var o=this.id;this.clazz&&this.method?t.httphandler.post(this.clazz,this.method,n,a,null,{dataType:"json",simple:!0}):t.ajax.post(this.pageName?this.pageName:null,this.listenerName,n,this.componentId?this.componentId:null,a,null,{dataType:"json",simple:!0})},ajaxCallback:function(i,e,a,n,s){if(this.setSearchData(e),a&&t.isFunction(a))a(i,n);else if(n&&s)return void alert(s);this.downLoadedStatusTrue()},setParams:function(t){this.params=t},updatePosition:function(i,e,a){var n=t("#Div_Search_"+this.id);n.css("top",i+"px"),n.css("left",e+"px"),n.css("width",a+"px")},createOptionHtml:function(i,e,a){var n=[];n.push('<div id="Div_Search_'+this.id+'" class="c_option" style="left:'+e+"px; top:"+i+"px; width:"+a+'px;visibility:hidden">'),n.push('<div class="c_optionContent">'),n.push('<div id="List_Search_'+this.id+'" class="c_list c_list-table c_list-col-1">'),n.push('<ul id="Ul_Search_'+this.id+'">'),n.push("</ul>"),n.push("</div>"),n.push("</div>"),n.push('<div class="c_optionShadow" id="Shadow_Search_'+this.id+'"></div>'),n.push('<!--[if IE 6]><iframe class="c_optionCover"></iframe><![endif]-->'),n.push("</div>"),t.appendContextMenu(t("#"+this.id),t("#Div_Search_"+this.id),n.join(""),300,"Div_Search_"+this.id),t(document).bind("click",window["Search_"+this.id].HiddenLayerInDocument())},HiddenLayerInDocument:function(){var i=this.id;return function(e){var a=e.target,n=t(a).parents("[id="+i+"]");a.id==i||n&&n.length>0||(window["Search_"+i].hiddenSearch(),t("#Ul_Search_"+i).html(""))}},updateOptionHtml:function(i){var e=[];i&&0!=i.length||e.push('<li><a href="#nogo" class="text"><span>'+t.lang["view.web.comp.search.nodata"]+"</span></a></li>");var a=this.id,n=this.searchCode,s=this.maxOption,o=this.optionClass,r=0;i.each(function(t,i){return!(i>=s)&&(r++,e.push("<li searchIndex="+i+" onmouseover=\"$.Search.get('"+a+"').toggleMouseHover($(this),event)\" "),e.push(" onmouseout=\"$.Search.get('"+a+"').toggleMouseHover($(this),event)\" onclick=\"$.Search.get('"+a+"').optionClickAction($(this))\" "),t.eachKey(function(t,i){e.push(t+"='"+i+"' ")}),o&&""!=o&&e.push(' class="'+o+'"'),void e.push('><span class="text"><span>'+t.get(n)+"</span></span></li>"))}),t("#Ul_Search_"+this.id).html(e.join(""))},setSearchReturnValue:function(i){if(!i){for(var e=t("#Ul_Search_"+this.id+" li"),a=e.length,n=-1,s=0;s<a;s++){var o=t(e[s]).attr("class");o.indexOf("focus")!=-1&&(o=o.replace(/focus/g,""),t(e[s]).attr("class",o),n=s)}i=t(e[n])}this.valueCode&&t("#"+this.valueCode).val(i.attr(this.valueCode)),t("#"+this.id).val(i.attr(this.searchCode)),this.afterAction(),this.hiddenSearch(),t("#Ul_Search_"+this.id).html("")},toggleMouseHover:function(i,e,a){var n=t("#Ul_Search_"+this.id+" li"),s=n.length;if(!(s<=0)){for(var o=-1,r=0;r<s;r++){var h=t(n[r]).attr("class");h.indexOf("focus")!=-1&&(h=h.replace(/focus/g,""),t(n[r]).attr("class",h),o=r)}if(a==-1&&(o<=0&&(o=s),o--),1==a&&(o>=s-1&&(o=-1),o++),0==a&&(o=0),void 0!=a&&(i=t(n[o])),i&&i.length>0){var c=i.attr("class");c&&c.indexOf("focus")!=-1?c=c.replace(/focus/g,""):c&&""!=c?c+=" focus":c="focus",i.attr("class",c)}e=t.event.fix(e),e.stopPropagation()}},selectOption:function(t,i){this.toggleMouseHover(null,i,t)},clickAction:function(t,i){var e=t.val();e==this.defaultText?t.val(""):e&&""!=e&&t[0].select()},afterAction:function(){return!0},optionClickAction:function(t,i){this.setSearchReturnValue(t)},enterAction:function(t,i){return!0},optionEnterAction:function(t,i){this.setSearchReturnValue(),i.preventDefault(),i.stopPropagation()},keyDownAction:function(t,i){return this.fromKeyDown&&(this.loopKeyDown=!0),this.fromKeyDown=!0,this.loopKeyDown&&(this.loopKeyDown=!1,this.keyUpAction(t,i)),!0},keyUpAction:function(i,e){this.fromKeyDown=!1;var e=t.event.fix(e);if(38==e.which){var a=t("#Ul_Search_"+this.id+" li");return a&&a.length>0&&this.selectOption(-1,e),!0}if(40==e.which){var a=t("#Ul_Search_"+this.id+" li");if(a.length<=0){var n=this.id;return this.beginSearch(i.val(),function(){t.Search.get(n).selectOption(1,e)}),!0}return void this.selectOption(1,e)}if(13==e.which){var s=t("#Div_Search_"+this.id).css("visibility"),o=t("#Ul_Search_"+this.id+" li[class=focus]");return"hidden"!=s&&o&&o.length>0?this.optionEnterAction(i,e):this.enterAction(i,e),!1}(""==this.previousSearchData&&""!=i.val()||""!=this.previousSearchData&&this.previousSearchData!=i.val())&&(this.previousSearchData=i.val(),this.beginSearch(i.val()))},dynamic:!1,searchCode:"Key",valueCode:void 0,searchPosition:0,width:155,maxOption:20,dataLoaded:!0,nextSearchValue:"",defaultText:"",previousSearchData:"",optionClass:"",componentId:void 0,fromKeyDown:!1,loopKeyDown:!1},t.Search.fn.constructor.prototype=t.Search.fn,t.Search.get=t.Search.fn.get)}(Wade);