!function(t){"undefined"==typeof t.print&&(t.print=function(n,i,e,r){return new t.print.fn.construct(n,i,e,r)},t.print.fn={construct:function(t,n,i,e){this.printId=t,this.versionValue=i,this.codeValue=n,this.beforeAction=e},get:function(t){return window["Print_"+t]},createPrintControl:function(){if(!t.print.printObj){if(Wade.browser.msie)try{t.print.printObj=new ActiveXObject("Wade3Printer.Printer")}catch(n){}else 0==t("#wade4-com-proxy").length&&t(document.body).append('<embed id="wade4-com-proxy" type="application/wade4-com-proxy" hidden="true"></embed>'),t.print.printObj=t("#wade4-com-proxy")[0];t.print.printObj||alert(t.lang["view.web.comp.print.tip"])}return t.print.printObj},printPage:function(n,i,e,r){var a=t.redirect.buildUrl(n,i,e,"");this.printHTML(a,r)},printHTML:function(t,n){this.print(t,"HTML",n)},printDoc:function(t,n){this.print(t,"WORD",n)},print:function(n,i,e){if(this.beforeAction&&"null"!=this.beforeAction&&"undefined"!=this.beforeAction){var r=!0;if(r=t.isFunction(this.beforeAction)?this.beforeAction.call(this,this.printId):new Function("return "+this.beforeAction)().call(this,this.printId),0==r)return}"http://"+window.location.host+window.location.pathname;if("WORD"==i)n.indexOf("http://")==-1&&n.indexOf("ftp:")==-1&&(n="/"==n.substring(0,1)?"http://"+window.location.host+n:"http://"+window.location.host+"/"+n);else if(n.indexOf("http://")==-1&&n.indexOf("ftp:")==-1){var a=n.indexOf("?service=");0==a&&(n=window.location.pathname+n),n="/"==n.substring(0,1)?"http://"+window.location.host+n:"http://"+window.location.host+"/"+n}var o=this.createPrintControl(),s=this.buildPrintData(t.redirect.parseUrl(n),i,e);if(Wade.browser.msie)o.DoPrint(s);else{var p=o.exec("Wade3Printer.Printer","DoPrint",s);0!=p&&alert(p.getErr())}},buildPrintData:function(n,i,e){this.addTemplateParams(e);var r=t.print.dynamicTemplateParams.get(this.printId);r&&"undefined"!=r&&"null"!=r&&(r.lastIndexOf(",")==r.length-1&&(r=r.substring(0,r.length-1)),","==r.substring(0,1)&&(r=r.substring(1,r.length))),n.indexOf("template_code")==-1&&(n+=n.indexOf("?")==-1?"?template_code="+this.codeValue:"&template_code="+this.codeValue),n.indexOf("version")==-1&&(n+=n.indexOf("?")==-1?"?version="+this.versionValue:"&version="+this.versionValue);var a=t.print.dynamicParams.get(this.printId);return a&&(n+="&"+a),n=t.redirect.parseUrl(n),t.print.dynamicTemplateParams.put(this.printId,""),r&&"undefined"!=r&&"null"!=r?'[{"TEMP_PATH":"'+n+'","TEMP_TYPE":"'+i+'",'+r+"}]":'[{"TEMP_PATH":"'+n+'","TEMP_TYPE":"'+i+'"}]'},updateTemplate:function(t,n){this.versionValue=n,this.codeValue=t},updateParams:function(n){var i="";i=n instanceof t.DataMap?t.param(n.map):t.isString(n)?n:t.param(n);var e=i?i.substring(0,1):"";"&"!=e&&"?"!=e||(i=i.substring(1)),t.print.dynamicParams.put(this.printId,i)},addTemplateParams:function(n){var i=t.print.dynamicTemplateParams.get(this.printId);if(i&&"undefined"!=i||(i=""),t.isPlainObject(n))for(var e in n)i+='"'+e+'":"'+n[e]+'",';else n instanceof t.DataMap?n.eachKey(function(t){i+='"'+t+'":"'+n.get(t)+'",'}):i+=n;t.print.dynamicTemplateParams.put(this.printId,i)},addPrintParams:function(t,n){var i=this.createPrintControl();Wade.browser.msie?i.SetParam(t,n):i.exec("Wade3Printer.Printer","SetParam",t,n)},getPrintParams:function(t){var n="",i=this.createPrintControl();return n=Wade.browser.msie?i.GetParam(t):i.exec("Wade3Printer.Printer","GetParam",t)},setPos:function(n,i){var e=t.print.fn.createPrintControl();n&&e.SetLeft(n),i&&e.SetTop(i)}},t.print.fn.construct.prototype=t.print.fn,t.print.setPos=t.print.fn.setPos,t.print.get=t.print.fn.get,t.print.dynamicTemplateParams=new t.DataMap,t.print.dynamicParams=new t.DataMap,t.print.printObj)}(Wade);