!function(e){"undefined"==typeof e.simpleUpload&&(e.simpleUpload=function(a,l){return new e.simpleUpload.fn.construct(a,l)},e.simpleUpload.fn={construct:function(a,l){this.id=a,e.extend(this,l)},init:function(){var a=this,url="attach?action=upload&random="+Math.random()+"&ftpSite="+a.ftpSite+"&filePath="+a.filePath+"&needSuffix="+a.needSuffix;e.redirect&&e.redirect.parseUrl&&(url=e.redirect.parseUrl(url));var l={flash_url:"v4/component/upload/swfupload.swf",flash9_url:"v4/component/upload/swfupload_fp9.swf",upload_url:url,file_size_limit:a.fileSize+" MB",file_types:a.fileTypes,file_types_description:a.fileTypesDesc,file_queue_limit:0,button_placeholder_id:"SIMPLEUPLOAD_FLASH_"+a.id,button_width:83,button_height:23,button_action:-100,button_image_url:"v4/ecl/base/button-upload-right"+e.lang["view.web.comp.upload.image"]+".png",custom_settings:{file_field_id:a.id,file_need_suffix:a.needSuffix},button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,button_cursor:SWFUpload.CURSOR.HAND,file_queue_error_handler:a.fileQueueError,file_dialog_complete_handler:a.fileDialogComplete,upload_start_handler:a.uploadStart,upload_progress_handler:a.uploadProgress,upload_error_handler:a.uploadError,upload_success_handler:a.uploadSuccess};this.SimpleUploadObject=new SWFUpload(l)},fileQueueError:function(a,l,i){try{switch(l){case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:alert(e.lang.get("view.web.comp.upload.sizelimit","["+this.settings.file_size_limit+"]"));break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:alert(e.lang["view.web.comp.upload.size0"]);break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:alert(e.lang.get("view.web.comp.upload.type",a.type));break;case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:alert(e.lang.get("view.web.comp.upload.num","["+this.settings.file_upload_limit+"]"));break;default:alert(e.lang["view.web.comp.upload.error"]+i)}}catch(t){this.debug(t)}var o=this.customSettings.file_field_id;e("#"+o).val(""),e("#"+o+"_filename").val("");var d=e("#SIMPLEUPLOAD_SPAN_"+o);d.addClass("e_orange"),d.html(e.lang["view.web.comp.upload.retry"]),window["SimpleUpload_"+o].afterAction&&window[window["SimpleUpload_"+o].afterAction].call(window,"fail",o)},fileDialogComplete:function(e,a,l){try{this.startUpload()}catch(i){this.debug(i)}},uploadStart:function(a){var l=this.customSettings.file_field_id,i=e("#SIMPLEUPLOAD_SPAN_"+l);return i.removeClass("e_orange"),i.html('<i class="e_ico-loading"></i>'+e.lang["view.web.comp.upload.uploading"]),!0},uploadProgress:function(e,a,l){},uploadSuccess:function(a,l){var i,t=this.customSettings.file_field_id;try{var o,d=e.format.lowercase(a.type);o=".xls"===d||".xlsx"===d?"xls":".doc"===d||".docx"===d?"doc":".txt"===d?"txt":".xml"===d?"xml":".gif"===d||".jpg"===d||".png"===d||".ioc"===d?"pic":"file",i=e.parseJSON(l);var n=e("#"+t),p=n.val();n.val(i.data.fileId),e("#"+t+"_filename").val(a.name);var s=e("#SIMPLEUPLOAD_SPAN_"+t);s.removeClass("e_orange"),s.html(e.lang["view.web.comp.upload.afterupl"]+"<i class='e_ico-"+o+"'></i>"+a.name),p&&"yes"==n.attr("isupload")&&"true"==window["SimpleUpload_"+t].fileDelete&&e.post("attach?action=delete","fileId="+p+"&needSuffix="+window["SimpleUpload_"+t].needSuffix,function(e){},"POST"),n.attr("isupload","yes"),window["SimpleUpload_"+t].afterAction&&window[window["SimpleUpload_"+t].afterAction].call(window,"success",t,d)}catch(r){i||(alert(l),this.clearData()),this.debug(r)}},clearData:function(){var a=e("#"+this.id).val();a&&"true"==this.fileDelete&&e.post("attach?action=delete","fileId="+a+"&needSuffix="+window["SimpleUpload_"+this.id].needSuffix,function(e){},"POST"),e("#SIMPLEUPLOAD_SPAN_"+this.id).removeClass("e_orange"),e("#SIMPLEUPLOAD_SPAN_"+this.id).html(""),e("#"+this.id).val(""),e("#"+this.id+"_filename").val(""),this.afterAction&&window[this.afterAction].call(window,"del",this.id)},uploadError:function(a,l,i){try{switch(l){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:alert(e.lang["view.web.comp.upload.disconnect"]);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:alert(e.lang["view.web.comp.upload.fail"]+i);break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:alert(e.lang["view.web.comp.upload.readfail"]+i);break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:alert(e.lang["view.web.comp.upload.authority"]+i);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:alert(e.lang["view.web.comp.upload.content"]+"["+a.name+"]");break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:alert(e.lang["view.web.comp.upload.verify"]+"["+a.name+"]ï¼Œ"+i);break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:alert(e.lang.get("view.web.comp.upload.canceled","["+a.name+"]"));break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:alert(e.lang.get("view.web.comp.upload.stop","["+a.name+"]"))}}catch(t){this.debug(t)}var o=this.customSettings.file_field_id;e("#"+o).val(""),e("#"+o+"_filename").val("");var d=e("#SIMPLEUPLOAD_SPAN_"+o);d.addClass("e_orange"),d.html(e.lang["view.web.comp.upload.retry"]),window["SimpleUpload_"+o].afterAction&&window[window["SimpleUpload_"+o].afterAction].call(window,"fail",o)}},e.simpleUpload.fn.construct.prototype=e.simpleUpload.fn),e(window).bind("unload",function(){e("span[swfdelete=delete]").html("")})}(Wade);