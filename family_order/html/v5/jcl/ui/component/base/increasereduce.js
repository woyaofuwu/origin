/*!
 * increasereduce component
 * http://www.wadecn.com/
 * auth:xiedx@asiainfo.com
 * Copyright 2015, WADE
 */
!function(a,u,t){"use strict";if(a&&"undefined"==typeof a.IncreaseReduce){var e=t.createElement("input"),n="oninput"in e;e=null;var l,i="undefined"!=typeof a.hasTouch?a.hasTouch:"ontouchstart"in u,d=i?"touchend":"mouseup",r=i?"touchcancel":"mouseup",s=function(e,n){var i=this;i.el=e&&1==e.nodeType?e:t.getElementById(e),i.el&&i.el.nodeType&&(i.id=a.attr(i.el,"id"))&&(n&&a.isObject(n)&&a.extend(i,n),a.attr(i.el,"x-wade-uicomponent")||a.attr(i.el,"x-wade-uicomponent","increasereduce"),i._init(),i.constructor.call(i))};s.prototype=a.extend(new a.UIComponent,{val:function(e){var n=this;if(!a.isNumeric(e))return typeof n.value!=undefined&&null!=n.value?""+n.value:"";e=parseInt(e),n.min!=undefined&&e<n.min||n.max!=undefined&&e>n.max||(n.value=e,n.el.value=e)},getDisabled:function(){return this.disabled},setDisabled:function(e){var n=this;n.disabled=!!e;var i=n.div.className?n.div.className:"";n.disabled?((" "+i+" ").indexOf(" e_dis ")<0&&(n.div.className=a.trim(i+" e_dis")),n.el.disabled=!0):(i=a.trim((" "+i+" ").replace(/ e_dis /gi," ")),n.div.className=i,n.el.disabled=!1)},destroy:function(){var e=this;e.div=null,e.btnReduce=null,e.btnIncrease=null,e.el=null},_init:function(){var i=this;i.div=a(i.el).parent("div.e_mix:first")[0],i.btnReduce=a(i.div).children("span.e_ico-reduce:first")[0],i.btnIncrease=a(i.div).children("span.e_ico-add:first")[0],/^[0-9]+/gi.test(i.el.value)?i.el.value=i.value=parseInt(i.el.value):i.el.value=i.value=0,i.disabled&&i.setDisabled(!0),a(i.btnReduce).tap(function(){if(i.disabled)return!1;i._reduce()}),a(i.btnIncrease).tap(function(){if(i.disabled)return!1;i._increase()}),a(i.btnReduce).longTap(function(){if(i.disabled)return!1;l||i.increaseReduceInterval||(i.increaseReduceInterval=u.setInterval(function(){i._reduce()},500),l=i.id)}),a(i.btnIncrease).longTap(function(){if(i.disabled)return!1;l||i.increaseReduceInterval||(i.increaseReduceInterval=u.setInterval(function(){i._increase()},500),l=i.id)}),n?a(i.el).bind("input",function(e){var n;if(this.value=(""+this.value).replace(/[^0-9]+/gi,""),""!=this.value){if(n=parseInt(this.value),i.min!=undefined&&n<i.min||i.max!=undefined&&n>i.max)return void(this.value=i.value);this.value=n}n!=undefined&&(i.value=n)}):(a(i.el).bind("keydown",function(e){return!i.disabled&&(!(e.shiftKey||e.altKey||e.ctrlKey)&&(47<e.keyCode&&e.keyCode<58||95<e.keyCode&&e.keyCode<106||8==e.keyCode||46==e.keyCode))}),a(i.el).bind("keyup",function(e){if(i.disabled)return!1;var n;if(""!=this.value){if(n=parseInt(this.value),i.min!=undefined&&n<i.min||i.max!=undefined&&n>i.max)return void(this.value=i.value);this.value=n}n!=undefined&&(i.value=n)}))},_increase:function(){var e,n=this,i=n.value;if(a.isNumber(n.value)&&-1<n.value){if(e=n.value+n.step,n.max!=undefined&&e>n.max)return;n.value=e}e!=undefined&&(n.el.value=e),!1===a.event.trigger("change",null,n.el)&&(n.el.value=n.value=i)},_reduce:function(){var e,n=this,i=n.value;if(a.isNumber(n.value)&&0<n.value){if(e=n.value-n.step,n.min!=undefined&&e<n.min)return;n.value=e}e!=undefined&&(n.el.value=e),!1===a.event.trigger("change",null,n.el)&&(n.el.value=n.value=i)}}),a(function(){a(t.body).bind(d,c),i&&a(t.body).bind(r,c)}),u.IncreaseReduce=a.IncreaseReduce=s}function c(e){var n;l&&(n=u[l])&&(u.clearInterval(n.increaseReduceInterval),n.increaseReduceInterval=null),l=null}}(window.Wade,window,document);