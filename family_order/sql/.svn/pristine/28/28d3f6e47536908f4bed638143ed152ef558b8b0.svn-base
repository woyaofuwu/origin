SELECT A.SERIAL_NUMBER SERIAL_NUMBER,
       B.PAY_MODE_CODE PAY_MODE_CODE,
       B.PAY_NAME PAY_NAME,
       B.BANK_CODE BANK_CODE,
       B.BANK_ACCT_NO BANK_ACCT_NO,
       MAX(A.ACCEPT_DATE) ACCEPT_DATE
  FROM TF_BH_TRADE A, TF_F_ACCOUNT B
 WHERE A.ACCEPT_DATE >= TO_DATE(:START_DATE, 'yyyy-mm-dd')
   AND A.ACCEPT_DATE <= TO_DATE(:END_DATE, 'yyyy-mm-dd') + 1
   AND A.TRADE_STAFF_ID BETWEEN :START_STAFF_ID AND :END_STAFF_ID
   AND A.TRADE_CITY_CODE = :TRADE_CITY_CODE
   AND A.TRADE_TYPE_CODE = 80
   AND A.CUST_ID = B.CUST_ID
   AND B.PAY_MODE_CODE = :PAY_MODE_CODE
 GROUP BY B.CUST_ID,
          A.SERIAL_NUMBER,
          B.PAY_NAME,
          B.PAY_MODE_CODE,
          B.BANK_CODE,
          B.BANK_ACCT_NO