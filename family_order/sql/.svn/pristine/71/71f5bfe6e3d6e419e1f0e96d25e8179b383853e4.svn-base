SELECT /*+ LEADING(d) INDEX(a,PK_TF_B_TRADE)  use_nl(d,a)*/
 TO_CHAR(A.TRADE_ID) TRADE_ID,
 D.SERIAL_NUMBER,
 TO_CHAR(A.TRADE_TYPE_CODE) TRADE_TYPE_CODE,
 TRADE_TYPE,
 TO_CHAR(D.SCORE) SCORE,
 TO_CHAR(D.SCORE_CHANGED) SCORE_CHANGED,
 TO_CHAR(NVL(D.VALUE_CHANGED / 100, 0)) VALUE_CHANGED,
 D.REMARK,
 A.SERIAL_NUMBER SERIAL_NUMBER_B,
 CUST_NAME,
 TO_CHAR(ACCEPT_DATE, 'YYYY-MM-DD HH24:MI:SS') ACCEPT_DATE,
 TRADE_STAFF_ID,
 DECODE(A.CANCEL_TAG, '0', '正常', '1', '返销', '未知[' || A.CANCEL_TAG || ']') CANCEL_TAG,
 TO_CHAR(CANCEL_DATE, 'YYYY-MM-DD HH24:MI:SS') CANCEL_DATE,
 CANCEL_STAFF_ID,
 '' PARA_CODE16,
 '' PARA_CODE17,
 '' PARA_CODE18,
 '' PARA_CODE19,
 '' PARA_CODE20,
 '' PARA_CODE21,
 '' PARA_CODE22,
 '' PARA_CODE23,
 '' PARA_CODE24,
 '' PARA_CODE25,
 '' PARA_CODE26,
 '' PARA_CODE27,
 '' PARA_CODE28,
 '' PARA_CODE29,
 '' PARA_CODE30,
 '' START_DATE,
 '' END_DATE,
 '' EPARCHY_CODE,
 '' REMARK,
 '' UPDATE_STAFF_ID,
 '' UPDATE_DEPART_ID,
 '' UPDATE_TIME,
 '' SUBSYS_CODE,
 0 PARAM_ATTR,
 '' PARAM_CODE,
 '' PARAM_NAME
  FROM TF_B_TRADE A,
       TF_B_TRADE_SCORE D,
       TD_S_TRADETYPE C
 WHERE A.TRADE_ID = D.TRADE_ID
   AND D.SERIAL_NUMBER=:PARA_CODE3
   AND A.CANCEL_TAG IN ('0', '1')
   AND A.TRADE_EPARCHY_CODE = :PARA_CODE4
   AND A.TRADE_TYPE_CODE = C.TRADE_TYPE_CODE
   AND C.EPARCHY_CODE = :PARA_CODE4
   AND A.ACCEPT_DATE BETWEEN TO_DATE(:PARA_CODE1, 'YYYY-MM-DD') AND
       TO_DATE(:PARA_CODE2, 'YYYY-MM-DD') + 1
UNION ALL
SELECT /*+ LEADING(d) index(a,PK_TF_BH_TRADE) use_nl(d,a)*/
 TO_CHAR(A.TRADE_ID),
 D.SERIAL_NUMBER,
 TO_CHAR(A.TRADE_TYPE_CODE),
 TRADE_TYPE,
 TO_CHAR(D.SCORE),
 TO_CHAR(D.SCORE_CHANGED),
 TO_CHAR(NVL(D.VALUE_CHANGED / 100, 0)),
 D.REMARK,
 A.SERIAL_NUMBER,
 CUST_NAME,
 TO_CHAR(ACCEPT_DATE, 'YYYY-MM-DD HH24:MI:SS'),
 TRADE_STAFF_ID,
 DECODE(A.CANCEL_TAG, '0', '正常', '1', '返销', '未知[' || A.CANCEL_TAG || ']'),
 TO_CHAR(CANCEL_DATE, 'YYYY-MM-DD HH24:MI:SS'),
 CANCEL_STAFF_ID,
 '' PARA_CODE16,
 '' PARA_CODE17,
 '' PARA_CODE18,
 '' PARA_CODE19,
 '' PARA_CODE20,
 '' PARA_CODE21,
 '' PARA_CODE22,
 '' PARA_CODE23,
 '' PARA_CODE24,
 '' PARA_CODE25,
 '' PARA_CODE26,
 '' PARA_CODE27,
 '' PARA_CODE28,
 '' PARA_CODE29,
 '' PARA_CODE30,
 '' START_DATE,
 '' END_DATE,
 '' EPARCHY_CODE,
 '' REMARK,
 '' UPDATE_STAFF_ID,
 '' UPDATE_DEPART_ID,
 '' UPDATE_TIME,
 '' SUBSYS_CODE,
 0 PARAM_ATTR,
 '' PARAM_CODE,
 '' PARAM_NAME
  FROM TF_BH_TRADE A,
       TF_B_TRADE_SCORE D,
       TD_S_TRADETYPE C
 WHERE A.TRADE_ID = D.TRADE_ID
   AND D.SERIAL_NUMBER=:PARA_CODE3
   AND A.CANCEL_TAG IN ('0', '1')
   AND A.TRADE_EPARCHY_CODE = :PARA_CODE4
   AND A.TRADE_TYPE_CODE = C.TRADE_TYPE_CODE
   AND C.EPARCHY_CODE = :PARA_CODE4
   AND A.ACCEPT_DATE BETWEEN TO_DATE(:PARA_CODE1, 'YYYY-MM-DD') AND
       TO_DATE(:PARA_CODE2, 'YYYY-MM-DD') + 1