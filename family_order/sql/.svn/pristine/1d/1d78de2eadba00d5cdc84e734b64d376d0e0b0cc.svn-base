Select T2.*,0 x_Tag From Tf_f_User_Svc@Tobosscrm1 T1,(Select a.User_Id, c.* From Tf_f_User@Tobosscrm1 a,(Select Distinct b.Init_Serinum,Decode(b.Black_Type, '1', '黑名单', '0', '白名单') Black_Type,b.Start_Scout_Time,b.End_Scout_Time,b.Called_Serinum,b.Out_Reason,b.Out_Num,b.Msgid,b.Start_Time,b.End_Time,b.Eparchy_Code,b.Msg_Content,b.Remark,b.Update_Time,b.Upate_Staff,b.Update_Depart,b.Rsrv_Str1,b.Rsrv_Str2,b.Rsrv_Str3,0 x_Tag From Td_o_Blackuser_Sms b Where b.Start_Time >=To_Date(:start_Date, 'yyyy-mm-dd hh24:mi:ss')And (Substr(b.Init_Serinum, 1, 3) In ('134', '135', '136', '137', '138', '139', '150','151', '158', '159'))) c Where a.Serial_Number = c.Init_Serinum And a.Remove_Tag = '0') T2 Where T1.User_Id = T2.User_Id And T1.Service_Id = '5' And T1.End_Date >= Sysdate Union all Select T2.*,0 x_Tag From Tf_f_User_Svc@Tobosscrm2 T1,(Select a.User_Id, c.* From Tf_f_User@Tobosscrm2 a,(Select Distinct b.Init_Serinum,Decode(b.Black_Type, '1', '黑名单', '0', '白名单') Black_Type,b.Start_Scout_Time,b.End_Scout_Time,b.Called_Serinum,b.Out_Reason,b.Out_Num,b.Msgid,b.Start_Time,b.End_Time,b.Eparchy_Code,b.Msg_Content,b.Remark,b.Update_Time,b.Upate_Staff,b.Update_Depart,b.Rsrv_Str1,b.Rsrv_Str2,b.Rsrv_Str3,0 x_Tag From Td_o_Blackuser_Sms b Where b.Start_Time >=To_Date(:start_Date, 'yyyy-mm-dd hh24:mi:ss')And (Substr(b.Init_Serinum, 1, 3) In ('134', '135', '136', '137', '138', '139', '150','151', '158', '159'))) c Where a.Serial_Number = c.Init_Serinum And a.Remove_Tag = '0') T2 Where T1.User_Id = T2.User_Id And T1.Service_Id = '5' And T1.End_Date >= Sysdate Union All Select T2.*,0 x_Tag From Tf_f_User_Svc@Tobosscrm4 T1,(Select a.User_Id, c.* From Tf_f_User@Tobosscrm4 a,(Select Distinct b.Init_Serinum,Decode(b.Black_Type, '1', '黑名单', '0', '白名单') Black_Type,b.Start_Scout_Time,b.End_Scout_Time,b.Called_Serinum,b.Out_Reason,b.Out_Num,b.Msgid,b.Start_Time,b.End_Time,b.Eparchy_Code,b.Msg_Content,b.Remark,b.Update_Time,b.Upate_Staff,b.Update_Depart,b.Rsrv_Str1,b.Rsrv_Str2,b.Rsrv_Str3,0 x_Tag From Td_o_Blackuser_Sms b Where b.Start_Time >=To_Date(:start_Date, 'yyyy-mm-dd hh24:mi:ss')And (Substr(b.Init_Serinum, 1, 3) In ('134', '135', '136', '137', '138', '139', '150','151', '158', '159'))) c Where a.Serial_Number = c.Init_Serinum And a.Remove_Tag = '0') T2 Where T1.User_Id = T2.User_Id And T1.Service_Id = '5' And T1.End_Date >= Sysdate