select 
 TO_CHAR(A.TRADE_ID) TRADE_ID,
 D.SERIAL_NUMBER SERIAL_NUMBER,
 TO_CHAR(A.TRADE_TYPE_CODE) TRADE_TYPE_CODE,
 TRADE_TYPE TRADE_TYPE,
 TO_CHAR(D.SCORE) SCORE,
 TO_CHAR(D.SCORE_CHANGED) SCORE_CHANGED,
 TO_CHAR(NVL(D.VALUE_CHANGED / 100, 0)) VALUE_CHANGED,
 D.REMARK REMARK,
 A.SERIAL_NUMBER SERIAL_NUMBER_B,
 CUST_NAME,
 TO_CHAR(ACCEPT_DATE, 'YYYY-MM-DD HH24:MI:SS') ACCEPT_DATE,
 TRADE_STAFF_ID,
 DECODE(A.CANCEL_TAG, '0', '正常', '1', '返销', '未知[' || A.CANCEL_TAG || ']') CANCEL_TAG,
 TO_CHAR(CANCEL_DATE, 'YYYY-MM-DD HH24:MI:SS') CANCEL_DATE,
 CANCEL_STAFF_ID,
 A.RSRV_STR5 HANDLER_NAME,
 A.RSRV_STR6 HANDLER_PSPTID,
 A.RSRV_STR7 HANDLER_CONTACT
from TF_B_TRADE A,
     tf_b_trade_score D,
     TD_S_TRADETYPE C
where A.TRADE_ID = D.TRADE_ID     
   AND D.SERIAL_NUMBER= :PARA_CODE3
   AND A.CANCEL_TAG IN ('0', '1')
   AND A.TRADE_EPARCHY_CODE = :PARA_CODE4
   AND A.TRADE_TYPE_CODE = C.TRADE_TYPE_CODE
   AND C.EPARCHY_CODE = :PARA_CODE4
   AND A.ACCEPT_DATE+0 BETWEEN TO_DATE(:PARA_CODE1, 'YYYY-MM-DD') AND
       TO_DATE(:PARA_CODE2, 'YYYY-MM-DD') + 1
       
union all       
       
SELECT 
 TO_CHAR(A.TRADE_ID),
 D.SERIAL_NUMBER,
 TO_CHAR(A.TRADE_TYPE_CODE),
 TRADE_TYPE,
 TO_CHAR(D.SCORE),
 TO_CHAR(D.SCORE_CHANGED),
 TO_CHAR(NVL(D.VALUE_CHANGED / 100, 0)),
 D.REMARK,
 A.SERIAL_NUMBER,
 CUST_NAME,
 TO_CHAR(ACCEPT_DATE, 'YYYY-MM-DD HH24:MI:SS'),
 TRADE_STAFF_ID,
 DECODE(A.CANCEL_TAG, '0', '正常', '1', '返销', '未知[' || A.CANCEL_TAG || ']') CANCEL_TAG,
 TO_CHAR(CANCEL_DATE, 'YYYY-MM-DD HH24:MI:SS'),
 CANCEL_STAFF_ID,
 A.RSRV_STR5 HANDLER_NAME,
 A.RSRV_STR6 HANDLER_PSPTID,
 A.RSRV_STR7 HANDLER_CONTACT
  FROM TF_BH_TRADE A,
       TF_B_TRADE_SCORE D,
       TD_S_TRADETYPE C
 WHERE A.TRADE_ID = D.TRADE_ID
   AND D.SERIAL_NUMBER= :PARA_CODE3
   AND A.CANCEL_TAG IN ('0', '1')
   AND A.TRADE_EPARCHY_CODE = :PARA_CODE4
   AND A.TRADE_TYPE_CODE = C.TRADE_TYPE_CODE
   AND C.EPARCHY_CODE = :PARA_CODE4
   AND A.ACCEPT_DATE+0 BETWEEN TO_DATE(:PARA_CODE1, 'YYYY-MM-DD') AND
       TO_DATE(:PARA_CODE2, 'YYYY-MM-DD') + 1