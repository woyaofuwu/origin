SELECT V.VIP_ID,
       V.USECUST_ID,
       V.USER_ID,
       V.SERIAL_NUMBER,
       V.CITY_CODE,
       V.VIP_TYPE_CODE,
       V.VIP_CLASS_ID,
       V.VIP_CARD_NO,
       V.CUST_MANAGER_ID,
       V.CUST_MANAGER_APPR,
       TO_CHAR(V.OPEN_DATE, 'yyyy-mm-dd') OPEN_DATE,
       V.REMOVE_TAG,
       V.VIP_TYPE_CODE_B,
       V.VIP_CLASS_ID_B,
       V.SVC_MODE_CODE,
       V.MONTH_FEE,
       V.SVC_CYCLE_CODE,
       TO_CHAR(V.BIRTHDAY, 'yyyy-mm-dd') CBIRTHDAY,
       M.CUST_MANAGER_NAME CLIENT_INFO1,
       M.SERIAL_NUMBER CLIENT_INFO2,
       F_SYS_GETCODENAME('depart_id', V.JOIN_DEPART_ID, NULL, NULL) CLIENT_INFO3,
       F_SYS_GETCODENAME('staff_id', V.JOIN_STAFF_ID, NULL, NULL) CLIENT_INFO4,
       F_SYS_GETCODENAME('class_id', V.VIP_TYPE_CODE, V.VIP_CLASS_ID, NULL) CLIENT_INFO5,
       M.DEPART_ID CLIENT_INFO6,
       TO_CHAR(V.JOIN_DATE, 'yyyy-mm-dd') JOIN_DATE,
       TO_CHAR(V.VIP_CARD_START_DATE, 'yyyy-mm-dd') VIP_CARD_START_DATE,
       TO_CHAR(V.VIP_CARD_END_DATE, 'yyyy-mm-dd') VIP_CARD_END_DATE,
       V.UPDATE_TIME,
       V.UPDATE_STAFF_ID,
       V.UPDATE_DEPART_ID,
       V.REMARK,
       V.SCORE_VALUE,
       V.CREDIT_CLASS,
       TO_CHAR(P.PSPT_END_DATE, 'yyyy-mm-dd') PSPT_END_DATE,
       P.PSPT_ADDR,
       P.SEX,
       TO_CHAR(P.BIRTHDAY, 'yyyy-mm-dd') BIRTHDAY,
       P.NATIONALITY_CODE,
       P.LOCAL_NATIVE_CODE,
       P.POPULATION,
       P.LANGUAGE_CODE,
       P.FOLK_CODE,
       P.PHONE,
       P.POST_CODE,
       P.POST_ADDRESS,
       P.FAX_NBR,
       P.EMAIL,
       P.CONTACT,
       P.CONTACT_PHONE,
       P.HOME_ADDRESS,
       P.WORK_NAME,
       P.WORK_DEPART,
       P.JOB,
       P.JOB_TYPE_CODE,
       P.EDUCATE_DEGREE_CODE,
       P.RELIGION_CODE,
       P.REVENUE_LEVEL_CODE,
       P.MARRIAGE,
       P.CHARACTER_TYPE_CODE,
       P.WEBUSER_ID,
       P.WEB_PASSWD,
       P.CONTACT_TYPE_CODE,
       F_SYS_GETCODENAME('class_id',
                         V.VIP_TYPE_CODE_B,
                         V.VIP_CLASS_ID_B,
                         NULL) PREVALUE2,
       F_SYS_GETCODENAME('vip_type_code', V.VIP_TYPE_CODE, NULL, NULL) PREVALUE3,
       F_SYS_GETCODENAME('vip_type_code', V.VIP_TYPE_CODE_B, NULL, NULL) PREVALUE4,
       P.CUST_NAME,
       P.PSPT_TYPE_CODE,
       P.PSPT_ID,
       V.EPARCHY_CODE,
       P.COMMUNITY_ID
  FROM TF_F_CUST_PERSON        P,
       TF_F_CUST_VIP           V,
       TF_F_CUST_MANAGER_STAFF M,
       TF_F_USER               U
 WHERE U.USECUST_ID = P.CUST_ID
   AND U.USER_ID = V.USER_ID
   AND V.CUST_MANAGER_ID = M.CUST_MANAGER_ID(+)
   AND V.REMOVE_TAG = :REMOVE_TAG
   AND V.SERIAL_NUMBER = :SERIAL_NUMBER
