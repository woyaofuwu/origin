--IS_CACHE=Y
SELECT A.SITE_CODE,DECODE(A.SITE_TYPE,'1','自营网点','2','合作网点') SITE_TYPE,A.DEPART_ID,
A.SITE_NAME,(SELECT B.AREA_NAME FROM TD_M_AREA B WHERE B.AREA_CODE=A.EPARCHY_CODE) EPARCHY_CODE,
(SELECT C.PARA_NAME FROM TD_M_RES_PARA C WHERE C.PARA_ATTR='4001' 
AND C.PARA_CODE1='REPAIR_SITE_LEVEL' AND C.PARA_CODE2=A.SITE_LEVEL  AND C.VALID_TAG='0') SITE_LEVEL,
A.EFFECTIVE_DATE,A.CLOSE_DATE,DECODE(A.VALID_TAG,'0','有效','1','无效') VALID_TAG,
TO_CHAR(A.UPDATE_TIME,'YYYY-MM-DD') UPDATE_TIME,A.REMARK,
f_res_getcodename('staff_id',A.UPDATE_STAFF_ID,'','') UPDATE_STAFF_ID,
f_res_getcodename('depart_id',A.UPDATE_DEPART_ID,'','') UPDATE_DEPART_ID,f_res_getcodename('depart_id',A.DEPART_ID,'','') DEPART_NAME,
A.SITE_TYPE as SITE_TYPE_CODE,A.SITE_LEVEL AS SITE_LEVEL_CODE
FROM TD_S_REPAIR_SITE A 
WHERE 1=1
AND (:SITE_CODE IS NULL OR A.SITE_CODE=:SITE_CODE)
AND (:SITE_NAME IS NULL OR A.SITE_NAME LIKE '%'||:SITE_NAME||'%')
AND (:SITE_TYPE IS NULL OR A.SITE_TYPE=:SITE_TYPE)
AND (:SITE_LEVEL IS NULL OR A.SITE_LEVEL=:SITE_LEVEL)
AND (:VALID_TAG IS NULL OR A.VALID_TAG=:VALID_TAG)