SELECT TO_CHAR(NVL(T.RSRV_DATE1, T.START_DATE), 'YYYY-MM-DD HH24:MI:SS') RSRV_DATE1,
       TO_CHAR(NVL(T.RSRV_DATE2, T.END_DATE), 'YYYY-MM-DD HH24:MI:SS') RSRV_DATE2,
       T.PACKAGE_ID
  FROM TF_F_USER_SALE_ACTIVE T
 where 1 = 1
   AND USER_ID = :USER_ID
   AND PARTITION_ID = MOD(:USER_ID, 10000)
   And PROCESS_TAG = '0'
   AND NVL(T.RSRV_DATE2, T.END_DATE) > Sysdate
   AND T.PRODUCT_ID IN (69908001, 69908015)
UNION
SELECT TO_CHAR(NVL(B.RSRV_DATE1, B.START_DATE), 'YYYY-MM-DD HH24:MI:SS') RSRV_DATE1,
       TO_CHAR(NVL(B.RSRV_DATE2, B.END_DATE), 'YYYY-MM-DD HH24:MI:SS') RSRV_DATE2,
       B.PACKAGE_ID
  FROM TF_F_USER_SALEACTIVE_BOOK B
 where 1 = 1
   AND USER_ID = :USER_ID
   AND PARTITION_ID = MOD(:USER_ID, 10000)
   And PROCESS_TAG = '0'
   AND b.deal_state_code = 0
   AND NVL(B.RSRV_DATE2, B.END_DATE) > Sysdate
   AND B.PRODUCT_ID IN (69908001, 69908015)