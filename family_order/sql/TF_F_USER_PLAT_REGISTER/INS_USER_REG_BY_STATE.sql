INSERT INTO TF_F_USER_PLAT_REGISTER(PARTITION_ID,USER_ID,SERIAL_NUMBER,BIZ_TYPE_CODE,ORG_DOMAIN,OPR_SOURCE,PASSWD,BIZ_STATE_CODE,OPEN_TAG,SVC_LEVEL,START_DATE,END_DATE,RSRV_NUM1,RSRV_NUM2,RSRV_NUM3,RSRV_NUM4,RSRV_NUM5,RSRV_STR1,RSRV_STR2,RSRV_STR3,RSRV_STR4,RSRV_STR5,RSRV_DATE1,RSRV_DATE2,RSRV_DATE3,REMARK,UPDATE_STAFF_ID,UPDATE_DEPART_ID,UPDATE_TIME)
SELECT PARTITION_ID,to_char(USER_ID) USER_ID,SERIAL_NUMBER,BIZ_TYPE_CODE,ORG_DOMAIN,OPR_SOURCE,PASSWD,decode(:BIZ_STATE_CODE,'N','A','A','N','A'),OPEN_TAG,SVC_LEVEL,TO_DATE(:START_DATE,'YYYY-MM-DD HH24:MI:SS'),TO_DATE('2049-12-31 23:59:59','YYYY-MM-DD HH24:MI:SS'),RSRV_NUM1,RSRV_NUM2,RSRV_NUM3,to_char(RSRV_NUM4) RSRV_NUM4,to_char(RSRV_NUM5) RSRV_NUM5,RSRV_STR1,RSRV_STR2,RSRV_STR3,RSRV_STR4,RSRV_STR5,RSRV_DATE1,RSRV_DATE2,RSRV_DATE3,REMARK,UPDATE_STAFF_ID,UPDATE_DEPART_ID,UPDATE_TIME
  FROM TF_F_USER_PLAT_REGISTER a
WHERE a.partition_id=MOD(TO_NUMBER(:USER_ID),10000)
   AND a.user_id=TO_NUMBER(:USER_ID)
   AND sysdate BETWEEN a.start_date+0 AND a.end_date+0
   AND a.BIZ_STATE_CODE = :BIZ_STATE_CODE
   AND EXISTS(SELECT 1 FROM td_s_commpara 
              WHERE param_attr = :PARAM_ATTR 
              AND param_code = to_char(a.BIZ_TYPE_CODE) 
              AND sysdate BETWEEN start_date AND end_date)