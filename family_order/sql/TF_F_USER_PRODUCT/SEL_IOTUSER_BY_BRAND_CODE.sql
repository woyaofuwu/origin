SELECT /*+ INDEX(U PK_TF_F_USER) INDEX(R IDX_TF_F_USER_RES_UID)*/  
    U.PARTITION_ID,
    U.USER_ID,
    U.CUST_ID,
    U.SERIAL_NUMBER,
    R.IMSI,
    TO_CHAR(U.OPEN_DATE, 'YYYY-MM-DD HH24:MM:SS') OPEN_DATE,
    TO_CHAR(U.UPDATE_TIME, 'YYYY-MM-DD HH24:MM:SS') U_UPDATE_TIME,
    TO_CHAR(R.UPDATE_TIME, 'YYYY-MM-DD HH24:MM:SS') R_UPDATE_TIME,
    U.USER_STATE_CODESET
  FROM TF_F_USER U 
  LEFT JOIN TF_F_USER_PRODUCT P on P.USER_ID = U.USER_ID
  LEFT JOIN TF_F_USER_RES R ON R.USER_ID = P.USER_ID
  WHERE U.REMOVE_TAG = '0'
    AND P.BRAND_CODE = :BRAND_CODE
    AND P.MAIN_TAG = '1'
    AND R.RES_TYPE_CODE = '1'
    AND SYSDATE BETWEEN P.START_DATE AND P.END_DATE
    AND SYSDATE BETWEEN R.START_DATE AND R.END_DATE
    AND U.PARTITION_ID BETWEEN :PARTITION_START AND :PARTITION_END