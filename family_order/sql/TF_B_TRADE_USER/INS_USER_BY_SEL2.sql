INSERT INTO TF_B_TRADE_USER
(ACCEPT_MONTH,ACCT_TAG,ASSURE_CUST_ID,ASSURE_DATE,ASSURE_TYPE_CODE,BASIC_CREDIT_VALUE,BRAND_CODE,CHANGEUSER_DATE,CITY_CODE,CITY_CODE_A,CONTRACT_ID,CREDIT_CLASS,CREDIT_CONTROL_ID,CREDIT_VALUE,CUST_ID,DESTROY_TIME,DEVELOP_CITY_CODE,DEVELOP_DATE,DEVELOP_DEPART_ID,DEVELOP_EPARCHY_CODE,DEVELOP_NO,DEVELOP_STAFF_ID,EPARCHY_CODE,FIRST_CALL_TIME,IN_DATE,IN_DEPART_ID,IN_NET_MODE,IN_STAFF_ID,LAST_STOP_TIME,MODIFY_TAG,MPUTE_DATE,MPUTE_MONTH_FEE,NET_TYPE_CODE,OPEN_DATE,OPEN_DEPART_ID,OPEN_MODE,OPEN_STAFF_ID,PREPAY_TAG,PRE_DESTROY_TIME,PRODUCT_ID,REMARK,REMOVE_CITY_CODE,REMOVE_DEPART_ID,REMOVE_EPARCHY_CODE,REMOVE_REASON_CODE,REMOVE_TAG,RSRV_DATE1,RSRV_DATE2,RSRV_DATE3,RSRV_NUM1,RSRV_NUM2,RSRV_NUM3,RSRV_NUM4,RSRV_NUM5,RSRV_STR1,RSRV_STR10,RSRV_STR2,RSRV_STR3,RSRV_STR4,RSRV_STR5,RSRV_STR6,RSRV_STR7,RSRV_STR8,RSRV_STR9,RSRV_TAG1,RSRV_TAG2,RSRV_TAG3,SCORE_VALUE,SERIAL_NUMBER,TRADE_ID,UPDATE_DEPART_ID,UPDATE_STAFF_ID,UPDATE_TIME,USECUST_ID,USER_DIFF_CODE,USER_ID,USER_PASSWD,USER_STATE_CODESET,USER_TAG_SET,USER_TYPE_CODE)
SELECT TO_NUMBER(SUBSTR(:TRADE_ID,5,2)),ACCT_TAG,ASSURE_CUST_ID,ASSURE_DATE,ASSURE_TYPE_CODE,BASIC_CREDIT_VALUE,BRAND_CODE,CHANGEUSER_DATE,CITY_CODE,CITY_CODE_A,CONTRACT_ID,CREDIT_CLASS,CREDIT_CONTROL_ID,CREDIT_VALUE,CUST_ID,NULL,DEVELOP_CITY_CODE,DEVELOP_DATE,DEVELOP_DEPART_ID,DEVELOP_EPARCHY_CODE,DEVELOP_NO,DEVELOP_STAFF_ID,EPARCHY_CODE,FIRST_CALL_TIME,IN_DATE,IN_DEPART_ID,IN_NET_MODE,IN_STAFF_ID,LAST_STOP_TIME,:MODIFY_TAG,MPUTE_DATE,MPUTE_MONTH_FEE,NET_TYPE_CODE,OPEN_DATE,OPEN_DEPART_ID,OPEN_MODE,OPEN_STAFF_ID,PREPAY_TAG,PRE_DESTROY_TIME,PRODUCT_ID,REMARK,REMOVE_CITY_CODE,REMOVE_DEPART_ID,REMOVE_EPARCHY_CODE,REMOVE_REASON_CODE,:REMOVE_TAG,RSRV_DATE1,RSRV_DATE2,RSRV_DATE3,RSRV_NUM1,RSRV_NUM2,RSRV_NUM3,RSRV_NUM4,RSRV_NUM5,RSRV_STR1,RSRV_STR10,RSRV_STR2,RSRV_STR3,RSRV_STR4,RSRV_STR5,RSRV_STR6,RSRV_STR7,RSRV_STR8,RSRV_STR9,RSRV_TAG1,RSRV_TAG2,RSRV_TAG3,SCORE_VALUE,SERIAL_NUMBER,TO_NUMBER(:TRADE_ID),UPDATE_DEPART_ID,UPDATE_STAFF_ID,to_date(:UPDATE_TIME,'yyyy-mm-dd hh24:mi:ss'),USECUST_ID,USER_DIFF_CODE,USER_ID,USER_PASSWD,USER_STATE_CODESET,USER_TAG_SET,USER_TYPE_CODE
  FROM TF_F_USER A
 WHERE USER_ID = TO_NUMBER(:USER_ID)
   AND PARTITION_ID = MOD(TO_NUMBER(:USER_ID),10000)
   AND NOT EXISTS (SELECT 1 FROM TF_B_TRADE_USER
                    WHERE TRADE_ID = TO_NUMBER(:TRADE_ID)
                      AND ACCEPT_MONTH = TO_NUMBER(SUBSTR(:TRADE_ID,5,2))
                      and user_id = TO_NUMBER(:USER_ID))