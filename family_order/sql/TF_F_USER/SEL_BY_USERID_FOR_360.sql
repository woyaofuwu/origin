SELECT U.PARTITION_ID,
       U.USER_ID,
       U.CUST_ID,
       U.USECUST_ID,
       P.BRAND_CODE,
       P.PRODUCT_ID,
       U.EPARCHY_CODE,
       U.CITY_CODE,
       U.USER_PASSWD,
       U.USER_TYPE_CODE,
       U.SERIAL_NUMBER,
       U.ACCT_TAG,
       U.PREPAY_TAG,
       TO_CHAR(U.IN_DATE, 'YYYY-MM-DD HH24:MI:SS') IN_DATE,
       TO_CHAR(U.OPEN_DATE, 'YYYY-MM-DD HH24:MI:SS') OPEN_DATE,
       U.REMOVE_TAG,
       TO_CHAR(U.DESTROY_TIME, 'YYYY-MM-DD HH24:MI:SS') DESTROY_TIME,
       TO_CHAR(U.PRE_DESTROY_TIME, 'YYYY-MM-DD HH24:MI:SS') PRE_DESTROY_TIME,
       TO_CHAR(U.FIRST_CALL_TIME, 'YYYY-MM-DD HH24:MI:SS') FIRST_CALL_TIME,
       TO_CHAR(U.LAST_STOP_TIME, 'YYYY-MM-DD HH24:MI:SS') LAST_STOP_TIME,
       U.OPEN_MODE,
       U.USER_STATE_CODESET,
       U.MPUTE_MONTH_FEE,
       TO_CHAR(U.MPUTE_DATE, 'YYYY-MM-DD HH24:MI:SS') MPUTE_DATE,
       U.RSRV_STR1,
       U.RSRV_STR2,
       U.RSRV_STR3,
       U.RSRV_STR4,
       U.RSRV_STR5,
       U.RSRV_STR6,
       U.RSRV_STR7,
       U.RSRV_STR8,
       U.RSRV_STR9,
       U.RSRV_STR10,
       TO_CHAR(U.UPDATE_TIME, 'YYYY-MM-DD HH24:MI:SS') UPDATE_TIME,
       U.ASSURE_CUST_ID,
       U.ASSURE_TYPE_CODE,
       TO_CHAR(U.ASSURE_DATE, 'YYYY-MM-DD HH24:MI:SS') ASSURE_DATE,
       U.DEVELOP_EPARCHY_CODE,
       U.DEVELOP_CITY_CODE,
       U.DEVELOP_DEPART_ID,
       U.DEVELOP_STAFF_ID,
       TO_CHAR(U.DEVELOP_DATE, 'YYYY-MM-DD HH24:MI:SS') DEVELOP_DATE,
       U.DEVELOP_NO,
       U.IN_DEPART_ID,
       U.IN_STAFF_ID,
       U.REMOVE_EPARCHY_CODE,
       U.REMOVE_CITY_CODE,
       U.REMOVE_DEPART_ID,
       U.REMOVE_REASON_CODE,
       U.REMARK
  FROM TF_F_USER U, TF_F_USER_PRODUCT P
 WHERE 1 = 1
   AND U.USER_ID = TO_NUMBER(:USER_ID)
   AND U.PARTITION_ID = MOD(TO_NUMBER(:USER_ID), 10000)
   AND P.USER_ID = U.USER_ID
   AND P.PARTITION_ID = U.PARTITION_ID
   AND SYSDATE BETWEEN P.START_DATE AND P.END_DATE
   AND P.MAIN_TAG = '1'