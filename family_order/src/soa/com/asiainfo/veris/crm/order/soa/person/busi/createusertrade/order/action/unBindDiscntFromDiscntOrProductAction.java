package com.asiainfo.veris.crm.order.soa.person.busi.createusertrade.order.action;

import java.util.List;

import com.ailk.common.data.IData;
import com.ailk.common.data.IDataset;
import com.asiainfo.veris.crm.order.pub.frame.bcf.util.IDataUtil;
import com.asiainfo.veris.crm.order.pub.frame.bcf.util.SysDateMgr;
import com.asiainfo.veris.crm.order.soa.frame.bcf.bof.util.data.TradeTableEnum;
import com.asiainfo.veris.crm.order.soa.frame.bof.action.ITradeAction;
import com.asiainfo.veris.crm.order.soa.frame.bof.data.consts.BofConst;
import com.asiainfo.veris.crm.order.soa.frame.bof.data.tradedata.BusiTradeData;
import com.asiainfo.veris.crm.order.soa.frame.bof.data.tradedata.extend.DiscntTradeData;
import com.asiainfo.veris.crm.order.soa.frame.bof.data.tradedata.extend.ProductTradeData;
import com.asiainfo.veris.crm.order.soa.frame.bof.data.ucadata.UcaData;
import com.asiainfo.veris.crm.order.soa.frame.csservice.common.query.param.CommparaInfoQry;
import com.asiainfo.veris.crm.order.soa.frame.csservice.common.query.user.UserDiscntInfoQry;
import com.asiainfo.veris.crm.order.soa.frame.csservice.common.query.user.UserOfferRelInfoQry;

/**
 * REQ201807180046_新业务尝鲜季活动开发需求（第一阶段）
 * <br/>
 * 截至解绑开户绑定的优惠到月底结束，根据COMMPARA表param_attr=9230的配置进行解绑
 * <br/>
 * 这里只是解除特殊优惠(配置为9230),对其他优惠不处理
 * @author zhuoyingzhi
 * @date 20180727
 */
public class unBindDiscntFromDiscntOrProductAction implements ITradeAction
{

    public void executeAction(BusiTradeData btd) throws Exception
    {

        List<ProductTradeData> productTrade = btd.getTradeDatas(TradeTableEnum.TRADE_PRODUCT);

        //BindDiscntFromDiscntActionxxxxxxxxxxxxx32 {"TF_B_TRADE_SVC":{"USER_ID_A":"-1","MODIFY_TAG":"U","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"MAIN_TAG":"1","RSRV_STR9":null,"INST_ID":"1118071700818768","RSRV_STR7":null,"RSRV_STR8":null,"SERVICE_ID":"0","REMARK":null,"IS_NEED_PF":"0","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR6":null,"RSRV_STR3":"10004445","RSRV_STR4":"0","RSRV_STR1":null,"RSRV_STR10":null,"RSRV_STR2":null,"CAMPN_ID":null,"RSRV_TAG2":null,"PACKAGE_ID":"0","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_SVC":{"USER_ID_A":"-1","MODIFY_TAG":"U","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"MAIN_TAG":"0","RSRV_STR9":null,"INST_ID":"1118071700818776","RSRV_STR7":null,"RSRV_STR8":null,"SERVICE_ID":"1","REMARK":null,"IS_NEED_PF":"0","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR6":null,"RSRV_STR3":"10004445","RSRV_STR4":"10007931","RSRV_STR1":null,"RSRV_STR10":null,"RSRV_STR2":null,"CAMPN_ID":null,"RSRV_TAG2":null,"PACKAGE_ID":"10000712","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_SVC":{"USER_ID_A":"-1","MODIFY_TAG":"U","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"MAIN_TAG":"0","RSRV_STR9":null,"INST_ID":"1118071700818778","RSRV_STR7":null,"RSRV_STR8":null,"SERVICE_ID":"5","REMARK":null,"IS_NEED_PF":"0","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR6":null,"RSRV_STR3":"10004445","RSRV_STR4":"10007931","RSRV_STR1":null,"RSRV_STR10":null,"RSRV_STR2":null,"CAMPN_ID":null,"RSRV_TAG2":null,"PACKAGE_ID":"10000712","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_SVC":{"USER_ID_A":"-1","MODIFY_TAG":"U","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"MAIN_TAG":"0","RSRV_STR9":null,"INST_ID":"1118071700818781","RSRV_STR7":null,"RSRV_STR8":null,"SERVICE_ID":"8","REMARK":null,"IS_NEED_PF":"0","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR6":null,"RSRV_STR3":"10004445","RSRV_STR4":"10007931","RSRV_STR1":null,"RSRV_STR10":null,"RSRV_STR2":null,"CAMPN_ID":null,"RSRV_TAG2":null,"PACKAGE_ID":"10000712","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_SVC":{"USER_ID_A":"-1","MODIFY_TAG":"U","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"MAIN_TAG":"0","RSRV_STR9":null,"INST_ID":"1118071700818783","RSRV_STR7":null,"RSRV_STR8":null,"SERVICE_ID":"14","REMARK":null,"IS_NEED_PF":"0","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR6":null,"RSRV_STR3":"10004445","RSRV_STR4":"10007931","RSRV_STR1":null,"RSRV_STR10":null,"RSRV_STR2":null,"CAMPN_ID":null,"RSRV_TAG2":null,"PACKAGE_ID":"10000712","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_SVC":{"USER_ID_A":"-1","MODIFY_TAG":"U","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"MAIN_TAG":"0","RSRV_STR9":null,"INST_ID":"1118071700818785","RSRV_STR7":null,"RSRV_STR8":null,"SERVICE_ID":"18","REMARK":null,"IS_NEED_PF":"0","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR6":null,"RSRV_STR3":"10004445","RSRV_STR4":"10007931","RSRV_STR1":null,"RSRV_STR10":null,"RSRV_STR2":null,"CAMPN_ID":null,"RSRV_TAG2":null,"PACKAGE_ID":"10000712","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_SVC":{"USER_ID_A":"-1","MODIFY_TAG":"U","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"MAIN_TAG":"0","RSRV_STR9":null,"INST_ID":"1118071700818771","RSRV_STR7":null,"RSRV_STR8":null,"SERVICE_ID":"22","REMARK":null,"IS_NEED_PF":"0","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR6":null,"RSRV_STR3":"10004445","RSRV_STR4":"0","RSRV_STR1":null,"RSRV_STR10":null,"RSRV_STR2":null,"CAMPN_ID":null,"RSRV_TAG2":null,"PACKAGE_ID":"10000713","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_SVC":{"USER_ID_A":"-1","MODIFY_TAG":"U","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"MAIN_TAG":"0","RSRV_STR9":null,"INST_ID":"1118071700818789","RSRV_STR7":null,"RSRV_STR8":null,"SERVICE_ID":"202","REMARK":null,"IS_NEED_PF":"0","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR6":null,"RSRV_STR3":"10004445","RSRV_STR4":"10004454","RSRV_STR1":null,"RSRV_STR10":null,"RSRV_STR2":null,"CAMPN_ID":null,"RSRV_TAG2":null,"PACKAGE_ID":"10000715","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_SVC":{"USER_ID_A":"-1","MODIFY_TAG":"U","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"MAIN_TAG":"0","RSRV_STR9":null,"INST_ID":"1118071700818803","RSRV_STR7":null,"RSRV_STR8":null,"SERVICE_ID":"650","REMARK":"连带服务","IS_NEED_PF":"0","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR6":null,"RSRV_STR3":"10004445","RSRV_STR4":"10007931","RSRV_STR1":null,"RSRV_STR10":null,"RSRV_STR2":null,"CAMPN_ID":null,"RSRV_TAG2":null,"PACKAGE_ID":"10000712","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_SVC":{"USER_ID_A":"-1","MODIFY_TAG":"U","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"MAIN_TAG":"0","RSRV_STR9":null,"INST_ID":"1118071700818805","RSRV_STR7":null,"RSRV_STR8":null,"SERVICE_ID":"651","REMARK":"连带服务","IS_NEED_PF":"0","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR6":null,"RSRV_STR3":"10004445","RSRV_STR4":"10007931","RSRV_STR1":null,"RSRV_STR10":null,"RSRV_STR2":null,"CAMPN_ID":null,"RSRV_TAG2":null,"PACKAGE_ID":"10000712","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_SVC":{"USER_ID_A":"-1","MODIFY_TAG":"U","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"MAIN_TAG":"0","RSRV_STR9":null,"INST_ID":"1118071700818791","RSRV_STR7":null,"RSRV_STR8":null,"SERVICE_ID":"3000","REMARK":null,"IS_NEED_PF":"0","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR6":null,"RSRV_STR3":"10004445","RSRV_STR4":"10007931","RSRV_STR1":null,"RSRV_STR10":null,"RSRV_STR2":null,"CAMPN_ID":null,"RSRV_TAG2":null,"PACKAGE_ID":"10000712","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_SVC":{"USER_ID_A":"-1","MODIFY_TAG":"U","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"MAIN_TAG":"0","RSRV_STR9":null,"INST_ID":"1118071700818774","RSRV_STR7":null,"RSRV_STR8":null,"SERVICE_ID":"3011","REMARK":null,"IS_NEED_PF":"0","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR6":null,"RSRV_STR3":"10004445","RSRV_STR4":"0","RSRV_STR1":null,"RSRV_STR10":null,"RSRV_STR2":null,"CAMPN_ID":null,"RSRV_TAG2":null,"PACKAGE_ID":"0","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_SVC":{"USER_ID_A":"-1","MODIFY_TAG":"1","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2018-07-17 15:51:42","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"MAIN_TAG":"0","RSRV_STR9":null,"INST_ID":"1118071700818787","RSRV_STR7":null,"RSRV_STR8":null,"SERVICE_ID":"23","REMARK":null,"IS_NEED_PF":"","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10004445","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR6":null,"RSRV_STR3":null,"RSRV_STR4":null,"RSRV_STR1":null,"RSRV_STR10":null,"RSRV_STR2":null,"CAMPN_ID":null,"RSRV_TAG2":null,"PACKAGE_ID":"10007931","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_SVC":{"USER_ID_A":"-1","MODIFY_TAG":"0","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"MAIN_TAG":"0","RSRV_STR9":null,"INST_ID":"1118071700847709","RSRV_STR7":null,"RSRV_STR8":null,"SERVICE_ID":"231","REMARK":null,"IS_NEED_PF":null,"START_DATE":"2018-07-17 15:51:43","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":null,"RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR6":null,"RSRV_STR3":null,"RSRV_STR4":null,"RSRV_STR1":null,"RSRV_STR10":null,"RSRV_STR2":null,"CAMPN_ID":null,"RSRV_TAG2":null,"PACKAGE_ID":"10000712","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE":{"USER_ID_B":null,"CUST_ID":"1118071705870752","INTF_ID":null,"IN_MODE_CODE":"0","CANCEL_EPARCHY_CODE":null,"EPARCHY_CODE":"0898","USER_ID":"1118071737010641","PRIORITY":"320","CUST_ID_B":null,"ACCT_ID_B":null,"CANCEL_CITY_CODE":null,"FEE_STATE":"0","FOREGIFT":"0","SERV_REQ_ID":null,"ADVANCE_PAY":"0","SUBSCRIBE_TYPE":"0","EXEC_RESULT":null,"CITY_CODE":"HNSJ","PF_TYPE":null,"EXEC_TIME":"2018-07-17 15:51:43","OPER_FEE":"0","TERM_IP":"10.199.48.26","BPM_ID":null,"RSRV_STR5":null,"RSRV_STR6":null,"CANCEL_DATE":null,"RSRV_STR3":"","RSRV_STR4":null,"SERIAL_NUMBER_B":null,"RSRV_STR1":"G001","RSRV_STR2":"10004445","CANCEL_TAG":"0","FINISH_DATE":null,"TRADE_TYPE_CODE":"110","PROD_ORDER_ID":null,"FREE_RESOURCE_TAG":null,"FEE_TIME":null,"PROCESS_TAG_SET":"0000000000000000000F00000000000000000000","BATCH_ID":"","RSRV_STR9":null,"RSRV_STR7":null,"RSRV_STR8":null,"SERIAL_NUMBER":"13876113302","EXEC_ACTION":null,"CUST_CONTACT_ID":null,"BRAND_CODE":"G002","PF_WAIT":"0","REMARK":"","SUBSCRIBE_STATE":"0","IS_NEED_HUMANCHECK":null,"ACCT_ID":"1118071706502129","FEE_STAFF_ID":null,"EXEC_DESC":null,"INVOICE_NO":null,"PRODUCT_ID":"10002116","CANCEL_STAFF_ID":null,"OLCOM_TAG":"0","CANCEL_DEPART_ID":null,"NET_TYPE_CODE":"00","ORDER_ID":"1118071702747009","RSRV_STR10":null,"CAMPN_ID":null,"NEXT_DEAL_TAG":"0","CUST_NAME":"海口市豆腐干梵蒂冈"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"1","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"0","END_DATE":"2018-07-17 15:51:42","START_DATE":"2018-07-17 15:34:20","OFFER_TYPE":"P","INST_ID":"1118071700818770","GROUP_ID":"0","OFFER_CODE":"10004445","OFFER_INS_ID":"1118071700818756","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818768"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"0","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847689","GROUP_ID":"0","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818768"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"1","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"1","END_DATE":"2018-07-17 15:51:42","START_DATE":"2018-07-17 15:34:20","OFFER_TYPE":"P","INST_ID":"1118071700818777","GROUP_ID":"10007931","OFFER_CODE":"10004445","OFFER_INS_ID":"1118071700818756","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818776"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"1","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847690","GROUP_ID":"10000712","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818776"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"1","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"5","END_DATE":"2018-07-17 15:51:42","START_DATE":"2018-07-17 15:34:20","OFFER_TYPE":"P","INST_ID":"1118071700818780","GROUP_ID":"10007931","OFFER_CODE":"10004445","OFFER_INS_ID":"1118071700818756","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818778"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"5","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847691","GROUP_ID":"10000712","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818778"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"1","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"8","END_DATE":"2018-07-17 15:51:42","START_DATE":"2018-07-17 15:34:20","OFFER_TYPE":"P","INST_ID":"1118071700818782","GROUP_ID":"10007931","OFFER_CODE":"10004445","OFFER_INS_ID":"1118071700818756","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818781"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"8","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847692","GROUP_ID":"10000712","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818781"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"1","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"14","END_DATE":"2018-07-17 15:51:42","START_DATE":"2018-07-17 15:34:20","OFFER_TYPE":"P","INST_ID":"1118071700818784","GROUP_ID":"10007931","OFFER_CODE":"10004445","OFFER_INS_ID":"1118071700818756","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818783"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"14","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847693","GROUP_ID":"10000712","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818783"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"1","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"18","END_DATE":"2018-07-17 15:51:42","START_DATE":"2018-07-17 15:34:20","OFFER_TYPE":"P","INST_ID":"1118071700818786","GROUP_ID":"10007931","OFFER_CODE":"10004445","OFFER_INS_ID":"1118071700818756","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818785"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"18","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847694","GROUP_ID":"10000712","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818785"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"1","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"22","END_DATE":"2018-07-17 15:51:42","START_DATE":"2018-07-17 15:34:20","OFFER_TYPE":"P","INST_ID":"1118071700818773","GROUP_ID":"0","OFFER_CODE":"10004445","OFFER_INS_ID":"1118071700818756","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818771"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"22","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847695","GROUP_ID":"10000713","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818771"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"1","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"202","END_DATE":"2018-07-17 15:51:42","START_DATE":"2018-07-17 15:34:20","OFFER_TYPE":"P","INST_ID":"1118071700818790","GROUP_ID":"10004454","OFFER_CODE":"10004445","OFFER_INS_ID":"1118071700818756","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818789"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"202","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847696","GROUP_ID":"10000715","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818789"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"1","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"650","END_DATE":"2018-07-17 15:51:42","START_DATE":"2018-07-17 15:34:20","OFFER_TYPE":"P","INST_ID":"1118071700818804","GROUP_ID":"10007931","OFFER_CODE":"10004445","OFFER_INS_ID":"1118071700818756","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818803"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"650","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847697","GROUP_ID":"10000712","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818803"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"1","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"651","END_DATE":"2018-07-17 15:51:42","START_DATE":"2018-07-17 15:34:20","OFFER_TYPE":"P","INST_ID":"1118071700818806","GROUP_ID":"10007931","OFFER_CODE":"10004445","OFFER_INS_ID":"1118071700818756","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818805"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"651","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847698","GROUP_ID":"10000712","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818805"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"1","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"3000","END_DATE":"2018-07-17 15:51:42","START_DATE":"2018-07-17 15:34:20","OFFER_TYPE":"P","INST_ID":"1118071700818792","GROUP_ID":"10007931","OFFER_CODE":"10004445","OFFER_INS_ID":"1118071700818756","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818791"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"3000","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847699","GROUP_ID":"10000712","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818791"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"1","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"3011","END_DATE":"2018-07-17 15:51:42","START_DATE":"2018-07-17 15:34:20","OFFER_TYPE":"P","INST_ID":"1118071700818775","GROUP_ID":"0","OFFER_CODE":"10004445","OFFER_INS_ID":"1118071700818756","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818774"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"3011","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847700","GROUP_ID":"0","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818774"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"1","REL_OFFER_TYPE":"D","USER_ID":"1118071737010641","REL_OFFER_CODE":"6633","END_DATE":"2018-07-17 15:51:42","START_DATE":"2018-07-17 15:34:20","OFFER_TYPE":"P","INST_ID":"1118071700818764","GROUP_ID":"10004448","OFFER_CODE":"10004445","OFFER_INS_ID":"1118071700818756","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818763"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"D","USER_ID":"1118071737010641","REL_OFFER_CODE":"6633","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847701","GROUP_ID":"10000961","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818763"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"1","REL_OFFER_TYPE":"D","USER_ID":"1118071737010641","REL_OFFER_CODE":"80001401","END_DATE":"2018-07-17 15:51:42","START_DATE":"2018-07-17 15:34:20","OFFER_TYPE":"P","INST_ID":"1118071700818767","GROUP_ID":"99991111","OFFER_CODE":"10004445","OFFER_INS_ID":"1118071700818756","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818766"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"D","USER_ID":"1118071737010641","REL_OFFER_CODE":"80001401","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847702","GROUP_ID":"99991111","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818766"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"1","REL_OFFER_TYPE":"D","USER_ID":"1118071737010641","REL_OFFER_CODE":"4448","END_DATE":"2018-07-31 23:59:59","START_DATE":"2018-07-17 15:34:20","OFFER_TYPE":"P","INST_ID":"1118071700818758","GROUP_ID":"10004453","OFFER_CODE":"10004445","OFFER_INS_ID":"1118071700818756","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818757"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"1","REL_OFFER_TYPE":"D","USER_ID":"1118071737010641","REL_OFFER_CODE":"4458","END_DATE":"2018-07-31 23:59:59","START_DATE":"2018-07-17 15:34:20","OFFER_TYPE":"P","INST_ID":"1118071700818761","GROUP_ID":"10004450","OFFER_CODE":"10004445","OFFER_INS_ID":"1118071700818756","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818760"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"1","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"23","END_DATE":"2018-07-17 15:51:42","START_DATE":"2018-07-17 15:34:20","OFFER_TYPE":"P","INST_ID":"1118071700818788","GROUP_ID":"10007931","OFFER_CODE":"10004445","OFFER_INS_ID":"1118071700818756","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700818787"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"D","USER_ID":"1118071737010641","REL_OFFER_CODE":"2116","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847704","GROUP_ID":"0","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700847703"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"D","USER_ID":"1118071737010641","REL_OFFER_CODE":"2117","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847707","GROUP_ID":"0","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700847706"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"S","USER_ID":"1118071737010641","REL_OFFER_CODE":"231","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847710","GROUP_ID":"10000712","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700847709"}}{"TF_B_TRADE_OFFER_REL":{"REL_TYPE":"C","MODIFY_TAG":"0","REL_OFFER_TYPE":"D","USER_ID":"1118071737010641","REL_OFFER_CODE":"1292","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"P","INST_ID":"1118071700847713","GROUP_ID":"10000711","OFFER_CODE":"10002116","OFFER_INS_ID":"1118071700847688","REL_USER_ID":"1118071737010641","REMARK":null,"REL_OFFER_INS_ID":"1118071700847711"}}{"TF_B_TRADE_ATTR":{"MODIFY_TAG":"0","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":"1292","USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"INST_ID":"1118071700847712","REMARK":null,"RELA_INST_ID":"1118071700847711","ELEMENT_ID":"1292","START_DATE":"2018-07-17 15:51:43","RSRV_DATE3":null,"ATTR_CODE":"10000000","RSRV_DATE2":null,"INST_TYPE":"D","RSRV_DATE1":null,"RSRV_STR5":null,"ATTR_VALUE":"30005208","RSRV_STR3":null,"RSRV_STR4":null,"RSRV_STR1":null,"RSRV_STR2":null,"RSRV_TAG2":null,"RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_PRICE_PLAN":{"USER_ID_A":"-1","MODIFY_TAG":"1","FEE":"5000","USER_ID":"1118071737010641","END_DATE":"2018-07-31 23:59:59","START_DATE":"2018-07-17 15:34:19","OFFER_TYPE":"D","INST_ID":"1118071700818759","PRICE_ID":"500000000329","BILLING_CODE":"4448","PRICE_PLAN_TYPE":"1","FEE_TYPE":"0","SPEC_TAG":"0","OFFER_INS_ID":"1118071700818757","FEE_TYPE_CODE":null,"RELATION_TYPE_CODE":null,"REMARK":null,"PRICE_PLAN_ID":"300030000329"}}{"TF_B_TRADE_PRICE_PLAN":{"USER_ID_A":"-1","MODIFY_TAG":"1","FEE":"8800","USER_ID":"1118071737010641","END_DATE":"2018-07-31 23:59:59","START_DATE":"2018-07-17 15:34:19","OFFER_TYPE":"D","INST_ID":"1118071700818762","PRICE_ID":"500000003224","BILLING_CODE":"4458","PRICE_PLAN_TYPE":"1","FEE_TYPE":"0","SPEC_TAG":"0","OFFER_INS_ID":"1118071700818760","FEE_TYPE_CODE":null,"RELATION_TYPE_CODE":null,"REMARK":null,"PRICE_PLAN_ID":"300030003224"}}{"TF_B_TRADE_PRICE_PLAN":{"USER_ID_A":"-1","MODIFY_TAG":"0","FEE":"800","USER_ID":"1118071737010641","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"D","INST_ID":"1118071700847705","PRICE_ID":"500000007038","BILLING_CODE":"2116","PRICE_PLAN_TYPE":"1","FEE_TYPE":"0","SPEC_TAG":"0","OFFER_INS_ID":"1118071700847703","FEE_TYPE_CODE":null,"RELATION_TYPE_CODE":"","REMARK":null,"PRICE_PLAN_ID":"300030007038"}}{"TF_B_TRADE_PRICE_PLAN":{"USER_ID_A":"-1","MODIFY_TAG":"0","FEE":"0","USER_ID":"1118071737010641","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"D","INST_ID":"1118071700847708","PRICE_ID":"500000002309","BILLING_CODE":"2117","PRICE_PLAN_TYPE":"1","FEE_TYPE":"0","SPEC_TAG":"0","OFFER_INS_ID":"1118071700847706","FEE_TYPE_CODE":null,"RELATION_TYPE_CODE":"","REMARK":null,"PRICE_PLAN_ID":"300030002309"}}{"TF_B_TRADE_PRICE_PLAN":{"USER_ID_A":"-1","MODIFY_TAG":"0","FEE":"0","USER_ID":"1118071737010641","END_DATE":"2050-12-31 23:59:59","START_DATE":"2018-07-17 15:51:43","OFFER_TYPE":"D","INST_ID":"1118071700847714","PRICE_ID":"500000000526","BILLING_CODE":"1292","PRICE_PLAN_TYPE":"1","FEE_TYPE":"0","SPEC_TAG":"0","OFFER_INS_ID":"1118071700847711","FEE_TYPE_CODE":null,"RELATION_TYPE_CODE":"","REMARK":null,"PRICE_PLAN_ID":"300030000526"}}{"TF_B_TRADE_PRODUCT":{"USER_ID_A":"-1","MODIFY_TAG":"0","PRODUCT_MODE":"00","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"OLD_BRAND_CODE":"G001","RSRV_NUM3":null,"MAIN_TAG":"1","INST_ID":"1118071700847688","OLD_PRODUCT_ID":"10004445","BRAND_CODE":"G002","REMARK":null,"START_DATE":"2018-07-17 15:51:43","PRODUCT_ID":"10002116","RSRV_DATE3":null,"RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR3":null,"RSRV_STR4":null,"RSRV_STR1":null,"RSRV_STR2":null,"CAMPN_ID":null,"RSRV_TAG2":null,"RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_PRODUCT":{"USER_ID_A":"-1","MODIFY_TAG":"1","PRODUCT_MODE":"00","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2018-07-17 15:51:42","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"OLD_BRAND_CODE":null,"RSRV_NUM3":null,"MAIN_TAG":"1","INST_ID":"1118071700818756","OLD_PRODUCT_ID":null,"BRAND_CODE":"G001","REMARK":null,"START_DATE":"2018-07-17 15:34:20","PRODUCT_ID":"10004445","RSRV_DATE3":null,"RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR3":null,"RSRV_STR4":null,"RSRV_STR1":null,"RSRV_STR2":null,"CAMPN_ID":null,"RSRV_TAG2":null,"RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_DISCNT":{"USER_ID_A":"-1","MODIFY_TAG":"U","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"INST_ID":"1118071700818763","REMARK":null,"IS_NEED_PF":"0","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR3":"10004445","RSRV_STR4":"10004448","RSRV_STR1":null,"RSRV_STR2":null,"DISCNT_CODE":"6633","CAMPN_ID":null,"SPEC_TAG":"0","RELATION_TYPE_CODE":null,"RSRV_TAG2":null,"PACKAGE_ID":"10000961","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_DISCNT":{"USER_ID_A":"-1","MODIFY_TAG":"U","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"INST_ID":"1118071700818766","REMARK":null,"IS_NEED_PF":"0","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR3":"10004445","RSRV_STR4":"99991111","RSRV_STR1":null,"RSRV_STR2":null,"DISCNT_CODE":"80001401","CAMPN_ID":null,"SPEC_TAG":"0","RELATION_TYPE_CODE":null,"RSRV_TAG2":null,"PACKAGE_ID":"99991111","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_DISCNT":{"USER_ID_A":"-1","MODIFY_TAG":"1","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2018-07-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"INST_ID":"1118071700818757","REMARK":null,"IS_NEED_PF":"","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10004445","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR3":null,"RSRV_STR4":null,"RSRV_STR1":null,"RSRV_STR2":null,"DISCNT_CODE":"4448","CAMPN_ID":null,"SPEC_TAG":"0","RELATION_TYPE_CODE":null,"RSRV_TAG2":null,"PACKAGE_ID":"10004453","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_DISCNT":{"USER_ID_A":"-1","MODIFY_TAG":"1","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2018-07-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"INST_ID":"1118071700818760","REMARK":null,"IS_NEED_PF":"","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10004445","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR3":null,"RSRV_STR4":null,"RSRV_STR1":null,"RSRV_STR2":null,"DISCNT_CODE":"4458","CAMPN_ID":null,"SPEC_TAG":"0","RELATION_TYPE_CODE":null,"RSRV_TAG2":null,"PACKAGE_ID":"10004450","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_DISCNT":{"USER_ID_A":"-1","MODIFY_TAG":"0","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"INST_ID":"1118071700847703","REMARK":null,"IS_NEED_PF":null,"START_DATE":"2018-07-17 15:51:43","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":null,"RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR3":null,"RSRV_STR4":null,"RSRV_STR1":null,"RSRV_STR2":null,"DISCNT_CODE":"2116","CAMPN_ID":null,"SPEC_TAG":"0","RELATION_TYPE_CODE":"","RSRV_TAG2":null,"PACKAGE_ID":"0","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_DISCNT":{"USER_ID_A":"-1","MODIFY_TAG":"0","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"INST_ID":"1118071700847706","REMARK":null,"IS_NEED_PF":null,"START_DATE":"2018-07-17 15:51:43","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":null,"RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR3":null,"RSRV_STR4":null,"RSRV_STR1":null,"RSRV_STR2":null,"DISCNT_CODE":"2117","CAMPN_ID":null,"SPEC_TAG":"0","RELATION_TYPE_CODE":"","RSRV_TAG2":null,"PACKAGE_ID":"0","RSRV_TAG3":null,"RSRV_TAG1":null}}{"TF_B_TRADE_DISCNT":{"USER_ID_A":"-1","MODIFY_TAG":"0","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"INST_ID":"1118071700847711","REMARK":null,"IS_NEED_PF":null,"START_DATE":"2018-07-17 15:51:43","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":null,"RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR3":null,"RSRV_STR4":null,"RSRV_STR1":null,"RSRV_STR2":null,"DISCNT_CODE":"1292","CAMPN_ID":null,"SPEC_TAG":"0","RELATION_TYPE_CODE":"","RSRV_TAG2":null,"PACKAGE_ID":"10000711","RSRV_TAG3":null,"RSRV_TAG1":null}}
        System.out.println("unBindDiscntFromDiscntOrProductActionxxxxxxxxxxxxx35 " + btd);

        /*
        {"TF_B_TRADE_DISCNT":{"USER_ID_A":"-1","MODIFY_TAG":"U","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"INST_ID":"1118071700818763","REMARK":null,"IS_NEED_PF":"0","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR3":"10004445","RSRV_STR4":"10004448","RSRV_STR1":null,"RSRV_STR2":null,"DISCNT_CODE":"6633","CAMPN_ID":null,"SPEC_TAG":"0","RELATION_TYPE_CODE":null,"RSRV_TAG2":null,"PACKAGE_ID":"10000961","RSRV_TAG3":null,"RSRV_TAG1":null}}, 
        {"TF_B_TRADE_DISCNT":{"USER_ID_A":"-1","MODIFY_TAG":"U","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"INST_ID":"1118071700818766","REMARK":null,"IS_NEED_PF":"0","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR3":"10004445","RSRV_STR4":"99991111","RSRV_STR1":null,"RSRV_STR2":null,"DISCNT_CODE":"80001401","CAMPN_ID":null,"SPEC_TAG":"0","RELATION_TYPE_CODE":null,"RSRV_TAG2":null,"PACKAGE_ID":"99991111","RSRV_TAG3":null,"RSRV_TAG1":null}}, 
        {"TF_B_TRADE_DISCNT":{"USER_ID_A":"-1","MODIFY_TAG":"1","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2018-07-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"INST_ID":"1118071700818757","REMARK":null,"IS_NEED_PF":"","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10004445","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR3":null,"RSRV_STR4":null,"RSRV_STR1":null,"RSRV_STR2":null,"DISCNT_CODE":"4448","CAMPN_ID":null,"SPEC_TAG":"0","RELATION_TYPE_CODE":null,"RSRV_TAG2":null,"PACKAGE_ID":"10004453","RSRV_TAG3":null,"RSRV_TAG1":null}}, 
        {"TF_B_TRADE_DISCNT":{"USER_ID_A":"-1","MODIFY_TAG":"1","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2018-07-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"INST_ID":"1118071700818760","REMARK":null,"IS_NEED_PF":"","START_DATE":"2018-07-17 15:34:19","PRODUCT_ID":"10004445","RSRV_DATE3":null,"OPER_CODE":"","RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR3":null,"RSRV_STR4":null,"RSRV_STR1":null,"RSRV_STR2":null,"DISCNT_CODE":"4458","CAMPN_ID":null,"SPEC_TAG":"0","RELATION_TYPE_CODE":null,"RSRV_TAG2":null,"PACKAGE_ID":"10004450","RSRV_TAG3":null,"RSRV_TAG1":null}}, 
        {"TF_B_TRADE_DISCNT":{"USER_ID_A":"-1","MODIFY_TAG":"0","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"INST_ID":"1118071700847703","REMARK":null,"IS_NEED_PF":null,"START_DATE":"2018-07-17 15:51:43","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":null,"RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR3":null,"RSRV_STR4":null,"RSRV_STR1":null,"RSRV_STR2":null,"DISCNT_CODE":"2116","CAMPN_ID":null,"SPEC_TAG":"0","RELATION_TYPE_CODE":"","RSRV_TAG2":null,"PACKAGE_ID":"0","RSRV_TAG3":null,"RSRV_TAG1":null}}, 
        {"TF_B_TRADE_DISCNT":{"USER_ID_A":"-1","MODIFY_TAG":"0","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"INST_ID":"1118071700847706","REMARK":null,"IS_NEED_PF":null,"START_DATE":"2018-07-17 15:51:43","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":null,"RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR3":null,"RSRV_STR4":null,"RSRV_STR1":null,"RSRV_STR2":null,"DISCNT_CODE":"2117","CAMPN_ID":null,"SPEC_TAG":"0","RELATION_TYPE_CODE":"","RSRV_TAG2":null,"PACKAGE_ID":"0","RSRV_TAG3":null,"RSRV_TAG1":null}}, 
        {"TF_B_TRADE_DISCNT":{"USER_ID_A":"-1","MODIFY_TAG":"0","RSRV_NUM4":null,"RSRV_NUM5":null,"END_DATE":"2050-12-31 23:59:59","RSRV_NUM1":null,"USER_ID":"1118071737010641","RSRV_NUM2":null,"RSRV_NUM3":null,"INST_ID":"1118071700847711","REMARK":null,"IS_NEED_PF":null,"START_DATE":"2018-07-17 15:51:43","PRODUCT_ID":"10002116","RSRV_DATE3":null,"OPER_CODE":null,"RSRV_DATE2":null,"RSRV_DATE1":null,"RSRV_STR5":null,"RSRV_STR3":null,"RSRV_STR4":null,"RSRV_STR1":null,"RSRV_STR2":null,"DISCNT_CODE":"1292","CAMPN_ID":null,"SPEC_TAG":"0","RELATION_TYPE_CODE":"","RSRV_TAG2":null,"PACKAGE_ID":"10000711","RSRV_TAG3":null,"RSRV_TAG1":null}}]
         */

        UcaData uca = btd.getRD().getUca();
        String UserId = uca.getUserId();
        List<DiscntTradeData> orderDiscntTradeList = btd.getTradeDatas(TradeTableEnum.TRADE_DISCNT);

        System.out.println("unBindDiscntFromDiscntOrProductActionxxxxxxxxxxxxxxxxxx58 " + orderDiscntTradeList);

        if (orderDiscntTradeList != null && orderDiscntTradeList.size() > 0) {
             int  orderDiscntSize=orderDiscntTradeList.size();
             
             //是否已经执行了解除特殊优惠操作,这里只需要执行一次就可以了
             boolean  tagDiscnt84008844=true;
             
             //默认需要修改  特殊优惠
             boolean  tagIsUpdate=true;
             
            for (int ij = 0; ij < orderDiscntSize; ij++) {
	            	//判断新老产品是否同时存在在配置表中
	            	if(ij==0){
	            		//只需要执行一次
	            		tagIsUpdate=isUpdateDiscnt84008844(productTrade);
	            	}   
                DiscntTradeData orderDiscntTradeData = orderDiscntTradeList.get(ij);
                if (BofConst.MODIFY_TAG_DEL.equals(orderDiscntTradeData.getModifyTag())) {
                    System.out.println("unBindDiscntFromDiscntOrProductActionxxxxxxxxxxxxx113 " + productTrade);
                    String prodId = "";//用户开户主产品。
                    if (productTrade != null && productTrade.size() > 0) {                 	
                    	
                        for (ProductTradeData product : productTrade) {
                            if (BofConst.MODIFY_TAG_DEL.equals(product.getModifyTag()) && "1".equals(product.getMainTag())) {
                                prodId = product.getProductId();

                                if(!"".equals(prodId) && prodId !=null){
                                
	                                IDataset commparaInfos9230 = CommparaInfoQry.getCommparaAllColByParser("CSM", "9230", prodId, btd.getRD().getUca().getUserEparchyCode());
	                                System.out.println("unBindDiscntFromDiscntOrProductActionxxxxxxxxxxxxx123 " + commparaInfos9230);
	                                if (IDataUtil.isNotEmpty(commparaInfos9230)&&tagDiscnt84008844&&tagIsUpdate) {
	
	                                    for (int i = 0; i < commparaInfos9230.size(); i++) {
	                                        String discntCode = commparaInfos9230.getData(i).getString("PARA_CODE1");//para_code1=后台绑定优惠
	
	                                        IDataset userDiscntDs = UserDiscntInfoQry.getAllDiscntByUserId(UserId, discntCode);
	                                        System.out.println("unBindDiscntFromDiscntOrProductActionxxxxxxxxxxxxx136 " + userDiscntDs);
	
	                                        if (userDiscntDs != null && userDiscntDs.size() > 0) {
	                                            for (int j = 0; j < userDiscntDs.size(); j++) {
	                                                IData data = userDiscntDs.getData(j);
	                                                String discntProductId = data.getString("PRODUCT_ID");
	                                                String discntPackageId = data.getString("PACKAGE_ID");
	                                                String discntInst = data.getString("INST_ID");
	                                                  /**
	                                                   * 如果userofferrelDs 有值说明是正常订购的
	                                                   */
	                                                IDataset userofferrelDs = UserOfferRelInfoQry.qryUserAllOfferRelByUserIdDiscntCode(UserId, discntCode, discntInst);
	                                                System.out.println("unBindDiscntFromDiscntOrProductActionxxxxxxxxxxxxx148 " + userofferrelDs);
	
	                                                if (userofferrelDs == null || userofferrelDs.size() == 0) {//赠送绑定的优惠
	                                                	//说明是赠送的,要把赠送的截止掉。
	                                                    DiscntTradeData delDiscnt = new DiscntTradeData();
	                                                    delDiscnt.setUserId(UserId);
	                                                    delDiscnt.setProductId(discntProductId);
	                                                    delDiscnt.setPackageId(discntPackageId);
	                                                    delDiscnt.setElementId(discntCode);
	                                                    delDiscnt.setInstId(discntInst);
	                                                    delDiscnt.setModifyTag(BofConst.MODIFY_TAG_DEL);
	                                                    delDiscnt.setStartDate(data.getString("START_DATE", "").trim());
	                                                    delDiscnt.setEndDate(SysDateMgr.getAddMonthsLastDay(1));
	                                                    delDiscnt.setRemark("通过产品解绑赠送的优惠");
	                                                    System.out.println("unBindDiscntFromDiscntOrProductActionxxxxxxxxxxxxx160 " + delDiscnt);
	                                                    btd.add(uca.getSerialNumber(), delDiscnt);
	                                                    tagDiscnt84008844=false;
	                                                }
	                                                
	                                            }
	                                        }
	                                    }
	                                }
                                
                                }
                            }
                        }
                    }
                }
            }
        }

    }
    
    
    public boolean  isUpdateDiscnt84008844(List<ProductTradeData> productTrade)throws Exception{    	
    	String  strTag="";
    	//正常情况下  productTrade 会有两条数据
    	if (productTrade != null && productTrade.size() > 0) {
	    		for (ProductTradeData product : productTrade) {
					if (BofConst.MODIFY_TAG_ADD.equals(product.getModifyTag())&& "1".equals(product.getMainTag())) {
							String prodIdAdd = product.getProductId();
							IDataset commparaInfos9230 =null;
									 commparaInfos9230=CommparaInfoQry.getCommparaAllColByParser("CSM", "9230", prodIdAdd,"0898");
							System.out.println("unBindDiscntFromDiscntOrProductActionAdd:"+commparaInfos9230);
							if (IDataUtil.isNotEmpty(commparaInfos9230)) {
								//新的产品存在配置中
								strTag=strTag+"1,";
							}else{
								strTag=strTag+"0,";
							}
					}
					
					if (BofConst.MODIFY_TAG_DEL.equals(product.getModifyTag())&& "1".equals(product.getMainTag())) {
						String prodIdDel = product.getProductId();
						IDataset commparaInfos9230 =null;
						         commparaInfos9230=CommparaInfoQry.getCommparaAllColByParser("CSM", "9230", prodIdDel,"0898");
						System.out.println("unBindDiscntFromDiscntOrProductActionDel:"+commparaInfos9230);
						if (IDataUtil.isNotEmpty(commparaInfos9230)) {
							//老产品存在配置中
							strTag=strTag+"1,";
						}else{
							strTag=strTag+"0,";
						}
				}
			}   		
    	}
		System.out.println("unBindDiscntFromDiscntOrProductActionisUpdateDiscnt84008844:"+strTag);
		if(strTag.indexOf("1,1,") >= 0){
			//新老产品同时存在,则不需要修改84008844 特殊优惠,保留原来的优惠
			return false;
		}else{
			//新老产品只有一种或都不存在,则需要修改84008844 特殊优惠
			return true;
		}
    }
    
}
